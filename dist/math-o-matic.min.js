!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.MathOMatic=t():e.MathOMatic=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(__webpack_require__.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__webpack_require__.d(r,a,function(t){return e[t]}.bind(null,a));return r},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=13)}([function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EqualsPriority=void 0;const n=a(r(10));!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE"}(t.EqualsPriority||(t.EqualsPriority={}));class Expr{constructor(e,t,r,a,s){if(this._id=n.default.next(),this.doc=e,this.precedence=t,this.tex=r,!a)throw Expr.error("Assertion failed",s);this.type=a,this.trace=s}expand(){return this.expandMetaCache?this.expandMetaCache:this.expandMetaCache=this.expandInternal()}equals(e,t){return this===e?[]:!!this.type.equals(e.type)&&(e.getEqualsPriority(t)>this.getEqualsPriority(t)?e.equalsInternal(this,t):this.equalsInternal(e,t))}isProved(e){e=e||[];for(var t=0;t<e.length;t++)if(e[t]==this)return!0;return this.isProvedInternal(e)}getProof(e,t,r,a=!1){return e.has(this)?[{_type:"R",ctr:r.next(),num:e.get(this),expr:this}]:t.has(this)?[{_type:"R",ctr:r.next(),num:t.get(this),expr:this}]:this.getProofInternal(e,t,r,a)}toString(){return this.toIndentedString(0)}error(e){return Expr.error(e,this.trace)}static error(e,t){return t?t.error(e):new Error(e)}static normalizePrecedence(e){if(!1===e)return[0,0];if(!0===e)return[2,0];if("number"==typeof e)return[0,e];if(!(e instanceof Array&&2==e.length))throw console.log(e),Error("wut");return e||!1}shouldConsolidate(e){var t=Expr.normalizePrecedence(this.precedence||!1),r=Expr.normalizePrecedence(e||!1);return(0!=t[0]||0!=t[1])&&!(t[0]<r[0]||t[0]==r[0]&&t[1]<r[1])}static escapeTeX(e){return e.replace(/&|%|\$|#|_|{|}|~|\^|\\/g,(e=>({"&":"\\&","%":"\\%",$:"\\$","#":"\\#",_:"\\_","{":"\\{","}":"\\}","~":"\\textasciitilde","^":"\\textasciicircum","\\":"\\textbackslash"}[e])))}static makeTeXName(e){var t=new RegExp(`^(?:([a-z])|(${["alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigma","tau","upsilon","phi","chi","psi","omega"].join("|")}))([0-9]*)$`,"i"),r=e.match(t);return r?(()=>{if(r[1])return r[1];var e=r[2].charCodeAt(0)<="Z".charCodeAt(0),t=r[2].toLowerCase();return e&&(t=t[0].toUpperCase()+t.substring(1)),"\\"+t})()+(r[3]?1==r[3].length?"_"+r[3]:`_{${r[3]}}`:""):1==e.length?Expr.escapeTeX(e):`\\mathrm{${Expr.escapeTeX(e)}}`}makeTeX(e,t,r){t=t||[],r=r||!1;var a=this.tex;return this.shouldConsolidate(r)&&(a="\\left("+a+"\\right)"),a.replace(/#([0-9]+)/g,((e,r)=>t[1*r-1]||`\\texttt{\\textcolor{red}{\\#${r}}}`)).replace(/<<(.+?)>>/,((t,r)=>`\\href{#${e}}{${r}}`))}}t.default=Expr,Expr.PREC_FUNEXPR=1e3,Expr.PREC_COMMA=1e3,Expr.PREC_COLONEQQ=1e5},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionalObjectType=t.SimpleObjectType=t.ObjectType=t.FunctionalMetaType=t.TeeType=t.Type=void 0;const n=a(r(10));class Type{constructor(e,t){this._id=n.default.next(),this.doc=e,this.trace=t}toString(){return this.toIndentedString(0)}equals(e){if(this===e)return!0;if(!(e instanceof Type))return!1;if(this instanceof TeeType!=e instanceof TeeType)return!1;if(this instanceof TeeType&&e instanceof TeeType){if(this.left.length!=e.left.length)return!1;for(var t=0;t<this.left.length;t++)if(!this.left[t].equals(e.left[t]))return!1;return this.right.equals(e.right)}if(this instanceof SimpleObjectType&&this.expr)return this.expr.equals(e);if(e instanceof SimpleObjectType&&e.expr)return this.equals(e.expr);if(this instanceof SimpleObjectType||e instanceof SimpleObjectType)return!1;if((this instanceof FunctionalObjectType||this instanceof FunctionalMetaType)&&(e instanceof FunctionalObjectType||e instanceof FunctionalMetaType)){if(this.from.length!=e.from.length)return!1;for(t=0;t<this.from.length;t++)if(!this.from[t].equals(e.from[t]))return!1;return this.to.equals(e.to)}throw Error("Unknown type format")}}t.Type=Type;class TeeType extends Type{constructor({left:e,right:t},r){if(super(null,r),!e||!t)throw Error("duh");this.left=e,this.right=t}toIndentedString(e){return`[${this.left.join(", ")} |- ${this.right}]`}resolve(){return this}isFunctional(){return!1}}t.TeeType=TeeType;class FunctionalMetaType extends Type{constructor({from:e,to:t},r){if(super(null,r),!e||!t)throw Error("duh");this.from=e,this.to=t}toIndentedString(e){return`[${this.from.join(", ")} -> ${this.to}]`}resolve(){return this}isFunctional(){return!0}}t.FunctionalMetaType=FunctionalMetaType;class ObjectType extends Type{constructor(e,t){super(e,t)}}t.ObjectType=ObjectType;class SimpleObjectType extends ObjectType{constructor({doc:e,name:t,expr:r},a){if(super(e,a),!t)throw Error("duh");this.name=t,this.expr=r}resolve(){return this.expr?this.expr.resolve():this}toIndentedString(e){return this.name}toTeXString(e){var t=`\\href{#type-${this.name}}{\\mathsf{${this.name}}}`;return e&&this.expr?t+"\\coloneqq"+this.expr.toTeXString():t}isFunctional(){return!!this.expr&&this.expr.isFunctional()}}t.SimpleObjectType=SimpleObjectType;class FunctionalObjectType extends ObjectType{constructor({from:e,to:t},r){super(null,r),this.from=e,this.to=t}resolve(){return new FunctionalObjectType({from:this.from.map((e=>e.resolve())),to:this.to.resolve()},this.trace)}toIndentedString(e){return`[${this.from.join(", ")} -> ${this.to}]`}toTeXString(e){return"\\left["+this.from.map((e=>e.toTeXString())).join("\\times ")+` \\to ${this.to.toTeXString()}\\right]`}isFunctional(){return!0}}t.FunctionalObjectType=FunctionalObjectType},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(r(0));class Fun extends i.default{constructor({doc:e,precedence:t,tex:r,annotations:a,rettype:n,name:s,params:p,expr:l},o){if(!s&&!l)throw i.default.error("Anonymous fun cannot be primitive",o);if(n&&l&&!n.equals(l.type))throw i.default.error(`Expression type ${l.type} failed to match the return type ${n} of fun ${s}`,o);if(!n&&!l)throw i.default.error("Cannot guess the return type of a primitive fun",o);super(e,t,r,new((n||l.type)instanceof f.ObjectType?f.FunctionalObjectType:f.FunctionalMetaType)({from:p.map((e=>e.type)),to:n||l.type},o),o),this.annotations=a,this.name=s,this.params=p,this.expr=l}get length(){return this.params.length}isProvedInternal(e){return this.expr&&this.expr.isProved(e)}getEqualsPriority(){return i.EqualsPriority.ONE}equalsInternal(e,t){if(!(this.isCallable(t)||e instanceof Fun&&e.isCallable(t)))return!1;for(var r=[],a=this.type.resolve().from,n=0;n<a.length;n++)r.push(new u.default({type:a[n],name:"$"+n,selector:null},this.trace));var s=[],p=this.isCallable(t)?(this.name&&s.push(this),this.call(r)):new l.default({fun:this,args:r},this.trace),i=e instanceof Fun&&e.isCallable(t)?(e.name&&s.push(e),e.call(r)):new l.default({fun:e,args:r},this.trace),o=p.equals(i,t);return o&&o.concat(s)}call(e){if(!this.expr)throw Error("Cannot call a primitive fun");if(this.params.length!=e.length)throw Error("Arguments length mismatch");for(var t=0;t<this.params.length;t++)if(!this.params[t].type.equals(e[t].type))throw Error("Illegal type");var r=new Map;for(t=0;t<this.params.length;t++)r.set(this.params[t],e[t]);return this.expr.substitute(r)}getProofInternal(e,t,r,a=!1){if(this instanceof o.default&&this.name&&!a)return[{_type:"RS",ctr:r.next(),expr:this}];if(!this.expr)return[{_type:"NP",ctr:r.next(),expr:this}];t=new Map(t);var n=r.peek()+1,s=[];return this instanceof o.default&&this.def$s.forEach((a=>{var n=a.expr.getProof(e,t,r);s=s.concat(n);var p=n[n.length-1].ctr;t.set(a,p)})),[{_type:"V",$lines:s,lines:this.expr.getProof(e,t,r),params:this.params,ctr:[n,r.peek()]}]}}t.default=Fun;const l=p(r(7)),o=p(r(3)),u=p(r(6)),f=r(1)},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(2));class Schema extends n.default{constructor({doc:e,tex:t,annotations:r,schemaType:a,name:n,params:p,context:i,def$s:l,expr:o},u){if(!o)throw s.default.error("wut",u);if("schema"!=a&&!n)throw s.default.error("wut",u);if(super({doc:e,precedence:!n&&s.default.PREC_FUNEXPR,tex:t,annotations:r,rettype:null,name:n,params:p,expr:o},u),this.schemaType=a,this.def$s=l||[],this.context=i,"theorem"==a&&!this.isProved())throw s.default.error(`Schema ${n} is marked as a theorem but it is not proved`,u)}isProvedInternal(e){if(this.isProvedCache)return!0;if(0==e.length&&"boolean"==typeof this.isProvedCache)return this.isProvedCache;var t="axiom"==this.schemaType||this.expr.isProved(e);return e.length||(this.isProvedCache=t),t}substitute(e){if(this.name)return this;this.params.some((t=>e.has(t)))&&(e=new Map(e),this.params.forEach((t=>{e.has(t)&&e.delete(t)})));var t=this.expr.substitute(e);return t==this.expr?this:new Schema({doc:null,tex:null,annotations:this.annotations,schemaType:"schema",name:null,params:this.params,context:this.context,def$s:this.def$s,expr:t},this.trace)}expandInternal(){return this.expr.expand()==this.expr?this:new Schema({doc:null,tex:null,annotations:this.annotations,schemaType:"schema",name:null,params:this.params,context:this.context,def$s:this.def$s,expr:this.expr.expand()},this.trace)}isCallable(e){return!0}toIndentedString(e,t){return[`∫ ${this.name||""}(${this.params.map((t=>t.toIndentedString(e))).join(", ")}) => {`,"\t"+this.expr.expand().toIndentedString(e+1),"}"].join("\n"+"\t".repeat(e))}toTeXString(e,t){if(!this.name)return[this.shouldConsolidate(e)?"\\left(":"",1==this.params.length?this.params[0].toTeXString(!1):`\\left(${this.params.map((e=>e.toTeXString(s.default.PREC_COMMA))).join(", ")}\\right)`,"\\mapsto ",this.expr.expand().toTeXString(!1),this.shouldConsolidate(e)?"\\right)":""].join("");var r="def-"+this.name,a=this.isProved()?"p":"np";return t?`\\href{#${r}}{\\htmlData{proved=${a}}{\\mathsf{${s.default.escapeTeX(this.name)}}}}\\mathord{\\left(${this.params.map((e=>e.toTeXStringWithId(s.default.PREC_COMMA)+(e.selector?`: \\texttt{@${e.selector}}`:""))).join(", ")}\\right)}:\\\\\\quad`+this.expr.expand().toTeXString(!0):`\\href{#${r}}{\\htmlData{proved=${a}}{\\mathsf{${s.default.escapeTeX(this.name)}}}}`}}t.default=Schema;const s=a(r(0))},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(r(0));class Variable extends i.default{constructor({doc:e,tex:t,sealed:r,type:a,name:n,expr:s},p){if(super(e,!1,t,a,p),"string"!=typeof n)throw i.default.error("Assertion failed",p);if(r&&!s)throw i.default.error("Cannot seal a primitive fun",p);if(s&&!a.equals(s.type))throw i.default.error(`Expression type ${s.type} failed to match the type ${a} of variable ${n}`,p);this.sealed=r,this.name=n,this.expr=s}isProvedInternal(e){return!1}substitute(e){return e.has(this)?e.get(this):(this.expr,this)}expandInternal(){return this}getEqualsPriority(e){return!this.expr||this.sealed&&!e.canUse(this)?i.EqualsPriority.ZERO:i.EqualsPriority.FOUR}equalsInternal(e,t){if(!this.expr)return!1;if(!this.sealed||t.canUse(this)){var r=this.expr.equals(e,t);return r?(r.push(this),r):r}return!1}getProofInternal(e,t,r){return[{_type:"NP",ctr:r.next(),expr:this}]}toSimpleString(){return this.type.toString()+" "+this.name}toIndentedString(e,t){return`${t?this.type+" ":""}${this.name}<${this._id}>`}toTeXString(e,t){return`\\href{#${this instanceof l.default?"id-"+this._id:"def-"+this.name}}{${this.tex||i.default.makeTeXName(this.name)}}${t&&this.expr?"\\coloneqq "+this.expr.toTeXString(i.default.PREC_COLONEQQ):""}`}}t.default=Variable;const l=p(r(6))},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const p=s(r(0));class $Variable extends p.default{constructor({name:e,expr:t},r){if(super(null,!1,null,t.type,r),!e||!t)throw p.default.error("Assertion failed",r);this.name=e,this.expr=t}isProvedInternal(e){return this.expr.isProved(e)}substitute(e){var t=this.expr.substitute(e);return t==this.expr?this:t}expandInternal(){var e=this.expr.expand();return e==this.expr?this:e}getEqualsPriority(){return p.EqualsPriority.FIVE}equalsInternal(e,t){return this.expr.equals(e,t)}getProofInternal(e,t,r){if(!t.has(this))throw Error(this.name+" is not defined");return[{_type:"R",ctr:r.next(),num:t.get(this),expr:this.expr}]}toIndentedString(e,t){return this.name}toTeXString(e,t){return`\\mathtt{${p.default.escapeTeX(this.name)}}`}}t.default=$Variable},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(4));class Parameter extends n.default{constructor({doc:e,tex:t,type:r,name:a,selector:n},s){super({doc:e,tex:t,sealed:!1,type:r,name:a,expr:null},s),this.selector=n}toTeXStringWithId(e,t){return[`\\htmlId{${"id-"+this._id}}{`,this.toTeXString(e,t),"}"].join("")}}t.default=Parameter},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(r(0));class Funcall extends i.default{constructor({fun:e,args:t},r){if(!e.type.isFunctional()){var a=u.isNameable(e)?e.name:"<anonymous>";throw i.default.error(a+" is not callable",r)}if(!(t instanceof Array)||t.map((e=>e instanceof i.default)).some((e=>!e)))throw i.default.error("Assertion failed",r);var n=e.type.resolve(),s=n.from,p=t.map((e=>e.type));if(s.length!=p.length)throw i.default.error(`Invalid number of arguments (expected ${s.length}): ${p.length}`,r);for(var l=0;l<s.length;l++)if(!s[l].equals(p[l]))throw i.default.error(`Argument #${l+1} has illegal argument type (expected ${s[l]}): ${p[l]}`,r);super(null,!1,null,n.to,r),this.fun=e,this.args=t}isProvedInternal(e){return this.fun.isProved(e)}substitute(e){var t=this.fun.substitute(e),r=this.args.map((t=>t.substitute(e)));return t==this.fun&&r.every(((e,t)=>e==this.args[t]))?this:new Funcall({fun:t,args:r},this.trace)}expandInternal(){var e=this.fun.expand(),t=this.args.map((e=>e.expand()));return e instanceof o.default&&e.expr&&(!e.name||e instanceof c.default)?e.call(t).expand():e==this.fun&&t.every(((e,t)=>e==this.args[t]))?this:new Funcall({fun:e,args:t},this.trace)}isExpandableOnce(e){for(var t=this.fun;t instanceof l.default;)t=t.expr;return!!(t instanceof h.default&&t.expr)||(t instanceof Funcall?t.isExpandableOnce(e):t instanceof o.default&&t.isCallable(e))}expandOnce(e){if(!this.isExpandableOnce(e))throw Error("Cannot expand");for(var t=[],r=this.fun;r instanceof l.default;)r=r.expr;if(r instanceof h.default&&r.expr)return t.push(r),{expanded:new Funcall({fun:r.expr,args:this.args},this.trace),used:t};if(r instanceof Funcall){var a=r.expandOnce(e);return t.push(...a.used),{expanded:new Funcall({fun:a.expanded,args:this.args},this.trace),used:t}}if(!(r instanceof o.default))throw Error("Something's wrong");return r.name&&t.push(r),{expanded:r.call(this.args),used:t}}getEqualsPriority(){return i.EqualsPriority.THREE}equalsInternal(e,t){if(!(e instanceof Funcall)){if(!this.isExpandableOnce(t))return!1;var{expanded:r,used:a}=this.expandOnce(t);return(p=r.equals(e,t))&&p.concat(a)}var n=(()=>{if(this.args.length!=e.args.length)return!1;for(var r=[],a=0;a<this.args.length;a++){var n=this.args[a].equals(e.args[a],t);if(!n)return!1;r=r.concat(n)}return r})();if(n){var s=this.fun.equals(e.fun,t);if(s)return s.concat(n)}if(this.isExpandableOnce(t)){var{expanded:r,used:a}=this.expandOnce(t);return(p=r.equals(e,t))&&p.concat(a)}if(e.isExpandableOnce(t)){var p,{expanded:r,used:a}=e.expandOnce(t);return(p=this.equals(r,t))&&p.concat(a)}return!1}getProofInternal(e,t,r){if(e.has(this.fun))return[{_type:"SE",ctr:r.next(),schema:e.get(this.fun),args:this.args,expr:this}];if(t.has(this.fun))return[{_type:"SE",ctr:r.next(),schema:t.get(this.fun),args:this.args,expr:this}];if(this.fun instanceof c.default&&this.fun.name)return[{_type:"RC",ctr:r.next(),expr:this}];if(!(this.fun instanceof c.default))return[{_type:"NP",ctr:r.next(),expr:this}];var a=this.fun.getProof(e,t,r);return[...a,{_type:"SE",ctr:r.next(),schema:a[a.length-1].ctr,args:this.args,expr:this}]}toIndentedString(e,t){var r=this.args.map((t=>t instanceof h.default?`${t.name}<${t._id}>`:t.toIndentedString(e+1)));return r.join("").length<=50?(r=(r=this.args.map((t=>t instanceof h.default?`${t.name}<${t._id}>`:t.toIndentedString(e)))).join(", "),this.fun instanceof c.default?`${this.fun.name||`(${this.fun})`}(${r})`:[this.fun instanceof o.default&&this.fun.name?this.fun.name:"("+this.fun.toIndentedString(e)+")",`(${r})`].join("")):(r=r.join(",\n"+"\t".repeat(e+1)),this.fun instanceof c.default?[this.fun.name||`(${this.fun.toIndentedString(e)})`,"(","\t"+r,")"].join("\n"+"\t".repeat(e)):[(this.fun instanceof o.default&&"name"in this.fun&&this.fun.name?this.fun.name:"("+this.fun.toIndentedString(e)+")")+"(","\t"+r,")"].join("\n"+"\t".repeat(e)))}toTeXString(e,t){if(this.fun instanceof c.default)return(this.fun.name?`\\href{#def-${this.fun.name}}{\\htmlData{proved=${this.fun.isProved()?"p":"np"}}{\\textsf{${i.default.escapeTeX(this.fun.name)}}}}`:this.fun.toTeXString(!1))+`\\mathord{\\left(${this.args.map((e=>e.toTeXString(i.default.PREC_COMMA))).join(", ")}\\right)}`;if(this.fun instanceof f.default)return this.fun.funcallToTeXString(this.args,e);var r=this.args.map((e=>e.toTeXString(i.default.PREC_COMMA)));return(!u.isNameable(this.fun)||!this.fun.name||this.fun instanceof h.default?this.fun.toTeXString(!1):i.default.makeTeXName(this.fun.name))+`\\mathord{\\left(${r.join(", ")}\\right)}`}}t.default=Funcall;const l=p(r(5)),o=p(r(2)),u=r(11),f=p(r(8)),c=p(r(3)),h=p(r(4))},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(2));class ObjectFun extends n.default{constructor({doc:e,precedence:t,tex:r,annotations:a,sealed:n,rettype:p,name:i,params:l,expr:o},u){if(super({doc:e,precedence:t,tex:r,annotations:a,rettype:p,name:i,params:l,expr:o},u),n&&!o)throw s.default.error("Cannot seal a primitive fun",u);this.sealed=n}substitute(e){if(!this.expr)return this;if(this.name)return this;this.params.some((t=>e.has(t)))&&(e=new Map(e),this.params.forEach((t=>{e.has(t)&&e.delete(t)})));var t=this.expr.substitute(e);return t==this.expr?this:new ObjectFun({doc:null,precedence:!1,tex:null,annotations:this.annotations,sealed:this.sealed,rettype:null,name:null,params:this.params,expr:t},this.trace)}expandInternal(){if(!this.expr)return this;if(this.type instanceof p.ObjectType&&this.name)return this;var e=this.expr.expand();return e==this.expr?this:new ObjectFun({doc:null,precedence:!1,tex:null,annotations:this.annotations,sealed:this.sealed,rettype:null,name:null,params:this.params,expr:e},this.trace)}isCallable(e){return this.expr&&(!this.sealed||e.canUse(this))}toIndentedString(e,t){return this.name?this.name:[`ƒ ${this.name||""}(${this.params.map((t=>t.toIndentedString(e))).join(", ")}) => {`,"\t"+this.expr.toIndentedString(e+1),"}"].join("\n"+"\t".repeat(e))}toTeXString(e,t){return this.name?t?this.expr?this.funcallToTeXString(this.params,s.default.PREC_COLONEQQ)+"\\coloneqq "+this.expr.toTeXString(s.default.PREC_COLONEQQ):this.funcallToTeXString(this.params,e):`\\href{#def-${this.name}}{${s.default.makeTeXName(this.name)}}`:(this.precedence=s.default.PREC_FUNEXPR,[this.shouldConsolidate(e)?"\\left(":"",1==this.params.length?this.params[0].toTeXString(!1):`\\left(${this.params.map((e=>e.toTeXString(s.default.PREC_COMMA))).join(", ")}\\right)`,"\\mapsto ",this.expr.expand().toTeXString(!1),this.shouldConsolidate(e)?"\\right)":""].join(""))}funcallToTeXString(e,t){var r=e.map((e=>e.toTeXString(this.tex?this.precedence:s.default.PREC_COMMA)));return this.tex?this.makeTeX("def-"+this.name,r,t):(this.name?`\\href{#def-${this.name}}{${s.default.makeTeXName(this.name)}}`:this.toTeXString(!1))+`\\mathord{\\left(${r.join(", ")}\\right)}`}}t.default=ObjectFun;const s=a(r(0)),p=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class ExecutionContext{constructor(e){this.usingList=e||[]}canUse(e){return this.usingList.includes(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0;t.default={peek:()=>a,next:()=>++a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNameable=void 0,t.isNameable=function isNameable(e){return"name"in e}},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=p(r(5)),l=s(r(0)),o=r(1);class Tee extends l.default{constructor({left:e,def$s:t,right:r},a){if(!(e instanceof Array&&e.every((e=>e.type instanceof o.ObjectType||e.type instanceof o.Type))))throw console.log(e),l.default.error("Assertion failed",a);if(t&&!(t instanceof Array&&t.every((e=>e instanceof i.default))))throw l.default.error("Assertion failed",a);if(!(r.type instanceof o.ObjectType||r.type instanceof o.Type))throw console.log(r),l.default.error("Assertion failed",a);super(null,!1,null,new o.TeeType({left:e.map((e=>e.type)),right:r.type},a),a),this.left=e,this.def$s=t||[],this.right=r,this.precedence=l.default.PREC_COMMA}isProvedInternal(e){return this.right.isProved(e.concat(this.left))}substitute(e){var t=this.left.map((t=>t.substitute(e))),r=this.right.substitute(e);return t.every(((e,t)=>e==this.left[t]))&&r==this.right?this:new Tee({left:t,def$s:null,right:r},this.trace)}expandInternal(){var e=this.left.map((e=>e.expand())),t=this.right.expand();return e.every(((e,t)=>e==this.left[t]))&&t==this.right?this:new Tee({left:e,def$s:null,right:t},this.trace)}getEqualsPriority(){return l.EqualsPriority.TWO}equalsInternal(e,t){if(!(e instanceof Tee))throw Error("Assertion failed");if(this.left.length!=e.left.length)throw Error("Assertion failed");for(var r=0;r<this.left.length;r++)if(!this.left[r].equals(e.left[r],t))return!1;return this.right.equals(e.right,t)}getProofInternal(e,t,r){e=new Map(e);var a=r.peek()+1,n=this.left.map((t=>(e.set(t,r.next()),{_type:"H",ctr:r.peek(),expr:t})));return t=new Map(t),[{_type:"T",leftlines:n,rightlines:this.def$s.map((a=>{var n=a.expr.getProof(e,t,r),s=n[n.length-1].ctr;return t.set(a,s),n})).flat(1).concat(this.right.getProof(e,t,r)),ctr:[a,r.peek()]}]}toIndentedString(e,t){return this.left.length?["\t"+this.left.map((t=>t.toIndentedString(e+1))).join(",\n"+"\t".repeat(e+1)),"|-","\t"+this.right.toIndentedString(e+1)].join("\n"+"\t".repeat(e)):"|- "+this.right.toIndentedString(e)}toTeXString(e,t){var r=this.expand();return[this.shouldConsolidate(e)?"\\left(":"",`{${r.left.map((e=>e.toTeXString(l.default.PREC_COMMA))).join(", ")} \\vdash ${r.right.toTeXString(l.default.PREC_COMMA)}}`,this.shouldConsolidate(e)?"\\right)":""].join("")}}t.default=Tee},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))((function(n,s){function fulfilled(e){try{step(a.next(e))}catch(e){s(e)}}function rejected(e){try{step(a.throw(e))}catch(e){s(e)}}function step(e){e.done?n(e.value):function adopt(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(14)),p=n(r(17)),i=n(r(19));let l,o;l=r(21),o=r(22);class Program{constructor(){this.scopeMap=new Map}loadModule(e,t){return a(this,void 0,void 0,(function*(){return this.loadingModules=[],this.scope=yield this.loadModuleInternal(e,t)}))}loadModuleInternal(e,t){return a(this,void 0,void 0,(function*(){if(this.scopeMap.has(e))return this.scopeMap.get(e);var r=this.loadingModules.indexOf(e);if(r>=0){if(r==this.loadingModules.length-1)throw Error(`Cannot self import (${e})`);var a=this.loadingModules.slice(r).concat(e);throw Error(`Circular import detected (${a.join(" -> ")}). Sadly, circular import is currently not supported.`)}this.loadingModules.push(e);var{fileUri:n,code:s}=yield t(e),p=new i.default(n,null);if(yield this.feed(s,p,t),this.loadingModules.pop()!=e)throw Error("Something's wrong");return this.scopeMap.set(e,p),p}))}feed(e,t=this.scope,r){return a(this,void 0,void 0,(function*(){for(var a=l.parse(e),n=0;n<a.length;n++){var p=a[n];switch(p._type){case"import":var i=yield this.loadModuleInternal(p.filename,r);t.importMap.set(p.filename,i);break;case"typedef":var o=s.default.type(p,t);if(t.hasType(o.name))throw t.error(`Type ${o.name} has already been declared`);t.addType(o);break;case"defv":var u=s.default.variable(p,t);if(t.hasVariable(u.name))throw t.error(`Definition ${u.name} has already been declared`);t.addVariable(u);break;case"defun":var f=s.default.fun(p,t);if(t.hasVariable(f.name))throw t.error(`Definition ${f.name} has already been declared`);t.addFun(f);break;case"defschema":var c=s.default.schema(p,t,null);if(t.hasSchema(c.name))throw t.error(`Schema ${c.name} has already been declared`);t.addSchema(c);break;default:throw Error("Unknown line type "+p._type)}}}))}evaluate(e){var t=o.parse(e),r=new i.default("<repl>",this.scope);switch(t._type){case"typedef":return s.default.type(t,r);case"defv":return s.default.variable(t,r);case"defun":return s.default.fun(t,r);case"defschema":case"schemaexpr":return s.default.schema(t,r,null);case"tee":return s.default.tee(t,r,null);case"reduction":return s.default.reduction(t,r,null);case"schemacall":return s.default.schemacall(t,r,null);case"var":return s.default.metavar(t,r);default:throw Error("Unknown line type "+t._type)}}getProofExplorer(e,t,r){return p.default.get(this.scope,e,t,r)}}t.default=Program,Program.parser=l,Program.evalParser=o},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(9)),s=a(r(5)),p=a(r(7)),i=a(r(8)),l=a(r(6)),o=a(r(15)),u=a(r(3)),f=a(r(12)),c=r(1),h=a(r(4)),g=a(r(16));function typeObjToString(e){if("type"!=e._type)throw Error("Assertion failed");return e.ftype?"["+e.from.map(typeObjToString).join(", ")+" -> "+typeObjToString(e.to)+"]":e.name}function typeObjToNestedArr(e){if("type"!=e._type)throw Error("Assertion failed");if(e.ftype){if(!e.from||!e.to)throw Error("Assertion failed");return e.from.map(typeObjToNestedArr).concat([typeObjToNestedArr(e.to)])}if(!(e=e).name)throw Error("Assertion failed");return e.name}function varObjToString(e){switch(e.type){case"@":case"$":case"normal":return""+e.name;default:throw Error("Unknown type "+e.type)}}class PI{static type(e,t){if("typedef"!=e._type)throw Error("Assertion failed");var r=t.extend("type",e.name,e.location),a=e.expr?r.getType(typeObjToNestedArr(e.expr)):null,n=e.name,s=e.doc;return a?new c.SimpleObjectType({doc:s,name:n,expr:a},r.trace):new c.SimpleObjectType({doc:s,name:n,expr:null},r.trace)}static variable(e,t){if(!["defv","var"].includes(e._type))throw Error("Assertion failed");var r=t.extend("variable",e.name,e.location);if("var"==e._type){if("normal"!=e.type)throw r.error(`Variable type ${e.type} not allowed`);if(!r.hasVariable(e.name))throw r.error("Undefined identifier "+varObjToString(e));return r.getVariable(e.name)}if(!r.hasType(typeObjToNestedArr(e.type)))throw r.error(`Type ${typeObjToString(e.type)} is not defined`);var a=r.getType(typeObjToNestedArr(e.type)),n=e.expr?PI.objectexpr(e.expr,r):null;return e.isParam?new l.default({doc:e.doc,tex:e.tex,type:a,name:e.name,selector:e.selector||null},r.trace):new h.default({doc:e.doc,tex:e.tex,sealed:!!e.sealed,type:a,name:e.name,expr:n||null},r.trace)}static fun(e,t){if("defun"!=e._type&&"funexpr"!=e._type)throw Error("Assertion failed");var r=t.extend("fun","defun"==e._type?e.name:"<anonymous>",e.location),a=null,n=!1,s=null,p=!1,o=null,u=null,f=null;if("defun"==e._type){if(a=e.doc,n=e.tex_attributes.precedence,s=e.tex,p=e.sealed,!r.hasType(typeObjToNestedArr(e.rettype)))throw r.error(`Type ${typeObjToString(e.rettype)} is not defined`);o=r.getType(typeObjToNestedArr(e.rettype)),u=e.name}var c=e.params.map((e=>{var t=PI.variable(e,r);if(r.hasOwnVariable(t.name))throw r.error(`Parameter ${t.name} has already been declared`);if(!(t instanceof l.default))throw Error("Something's wrong");return r.addVariable(t),t}));return e.expr&&(f=PI.objectexpr(e.expr,r)),new i.default({annotations:[],sealed:p,rettype:o,name:u,params:c,expr:f,doc:a,precedence:n,tex:s},r.trace)}static funcall(e,t){if("funcall"!=e._type)throw Error("Assertion failed");var r=t.extend("funcall","name"in e.schema?e.schema.name:null,e.location),a=PI.objectexpr(e.schema,r),n=e.args.map((e=>PI.objectexpr(e,r)));return new p.default({fun:a,args:n},r.trace)}static expr(e,t,r){if(!["tee","reduction","schemacall","schemaexpr","var","with"].includes(e._type))throw Error("Assertion failed");var a=t;switch(e._type){case"tee":return PI.tee(e,a,r);case"reduction":return PI.reduction(e,a,r);case"schemacall":return PI.schemacall(e,a,r);case"schemaexpr":return PI.schema(e,a,r);case"var":return PI.metavar(e,a);case"with":return PI.with(e,a,r);default:throw Error("wut")}}static objectexpr(e,t){if(!["funcall","funexpr","var"].includes(e._type))throw console.log(e),Error("Assertion failed");var r=t;switch(e._type){case"funcall":return PI.funcall(e,r);case"funexpr":return PI.fun(e,r);case"var":return PI.variable(e,r);default:throw Error("wut")}}static metavar(e,t){if("var"!=e._type)throw Error("Assertion failed");var r=t;switch(e.type){case"@":if(e.name.match(/^@h[0-9]+$/)){var a=e.name.slice(2),n=Number(a);if(0==n)throw r.error("@h0 is not allowed; hypothesis number starts from one");if("0"==a[0])throw r.error("Hypothesis number cannot start with 0");if(a.length>=16)throw r.error("Hypothesis number insanely big");if(n>r.hypotheses.length)throw r.error(`Hypothesis #${n} not found; there are only ${r.hypotheses.length} hypotheses available`);return r.hypotheses[n-1]}throw r.error("Unknown selector query "+varObjToString(e));case"$":if(!r.has$(e.name))throw r.error(varObjToString(e)+" is not defined");return r.get$(e.name);case"normal":if(!r.hasSchema(e.name))throw r.error(`Schema ${varObjToString(e)} is not defined`);return r.getSchema(e.name);default:throw r.error("Unknown type "+e.type)}}static with(e,t,r){if("with"!=e._type)throw Error("Assertion failed");var a=t.extend("with",null,e.location),n=PI.variable(e.with,a);if(a.hasOwnVariable(n.name))throw a.error(`Parameter ${n.name} has already been declared`);if(!(n instanceof h.default))throw Error("Something's wrong");a.addVariable(n);var s=e.def$s.map((e=>{var t=PI.def$(e,a,r);if(a.hasOwn$(t.name))throw a.error(e.name+" has already been declared");return a.add$(t)})),p=PI.expr(e.expr,a,r);return new g.default({variable:n,def$s:s,expr:p},a.trace)}static tee(e,t,r){if("tee"!=e._type)throw Error("Assertion failed");var a=t.extend("tee",null,e.location),n=e.left.map((e=>PI.expr(e,a,r))),s=a.extend("tee.right",null,e.right.location);n.forEach((e=>s.hypotheses.push(e)));var p=e.def$s.map((e=>{var t=PI.def$(e,s,r);if(s.hasOwn$(t.name))throw s.error(e.name+" has already been declared");return s.add$(t)})),i=PI.expr(e.right,s,r);return new f.default({left:n,def$s:p,right:i},a.trace)}static def$(e,t,r){if("def$"!=e._type)throw Error("Assertion failed");var a=t.extend("def$",e.name,e.location),n=PI.expr(e.expr,a,r);return new s.default({name:e.name,expr:n},a.trace)}static schema(e,t,r){if("defschema"!=e._type&&"schemaexpr"!=e._type)throw Error("Assertion failed");var a="defschema"==e._type?e.name:null,s=t.extend("schema",a,e.location),p="schema",i=null,o=[],f=r;if("defschema"==e._type){if(p=e.schemaType,i=e.doc,o=e.annotations,r)throw console.log(r),Error("duh");var c=e.using.map((e=>{if(!s.hasVariable(e))throw s.error(`Variable ${e} is not defined`);var t=s.getVariable(e);if(!t.expr)throw s.error(e+" is not a macro");return t}));f=new n.default(c)}var h=e.params.map((e=>{var t=PI.variable(e,s);if(s.hasOwnVariable(t.name))throw s.error(`Parameter ${t.name} has already been declared`);if(!(t instanceof l.default))throw Error("Something's wrong");return s.addVariable(t),t})),g=e.def$s.map((e=>{var t=PI.def$(e,s,f);if(s.hasOwn$(t.name))throw s.error(e.name+" has already been declared");return s.add$(t)})),d=PI.expr(e.expr,s,f);return new u.default({doc:i,tex:null,annotations:o,schemaType:p,name:a,params:h,context:f,def$s:g,expr:d},s.trace)}static schemacall(e,t,r){if("schemacall"!=e._type)throw Error("Assertion failed");var a=t.extend("schemacall","name"in e.schema?e.schema.name:null,e.location),n=PI.expr(e.schema,a,r),s=e.args.map((e=>PI.objectexpr(e,a)));return new p.default({fun:n,args:s},a.trace)}static reduction(e,t,r){if("reduction"!=e._type)throw Error("Assertion failed");if(!r)throw Error("duh");var a=t.extend("reduction","name"in e.subject?e.subject.name:null,e.location),n=PI.expr(e.subject,a,r),s=e.args?e.args.map((e=>e&&PI.objectexpr(e,a))):null,p=e.antecedents.map((e=>PI.expr(e,a,r))),i=e.as&&PI.expr(e.as,a,r);return new o.default({subject:n,args:s,antecedents:p,as:i},r,a.trace)}}t.default=PI},function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&a(t,e,r);return n(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=p(r(9)),l=p(r(2)),o=p(r(7)),u=s(r(0)),f=r(11),c=p(r(6)),h=p(r(3)),g=p(r(12)),d=r(1),$=p(r(4));class Reduction extends u.default{constructor({antecedents:e,subject:t,args:r,as:a},n,s){if(r){let e=t.type.resolve().from,a=r.map((e=>e&&e.type));if(e.length!=a.length)throw u.default.error(`Invalid number of arguments (expected ${e.length}): ${a.length}`,s);for(var p=0;p<e.length;p++)if(a[p]&&!e[p].equals(a[p]))throw u.default.error(`Argument #${p+1} has illegal argument type (expected ${e[p]}): ${a[p]}`,s)}if(t instanceof l.default){t.params.forEach(((e,t)=>{if(!(r&&r[t]||e.selector))throw u.default.error(`Argument #${t+1} could not be guessed`,s)}));var i=t.params.map(((p,i)=>{if(r&&r[i])return r[i];var l=t.expr.expand();if(!(l instanceof g.default))throw Error("wut");return Reduction.guess(p.selector,l.left,e,l.right,a,n,s)}));t=new o.default({fun:t,args:i},s)}else if(r)throw u.default.error("Something's wrong",s);if(!(t.type instanceof d.TeeType))throw u.default.error("Subject is not reducible",s);if(!(e instanceof Array)||e.map((e=>e instanceof u.default)).some((e=>!e)))throw u.default.error("Assertion failed",s);var f=t.type.left,c=e.map((e=>e.type));if(f.length!=c.length)throw u.default.error(`Invalid number of arguments (expected ${f.length}): ${c.length}`,s);for(let e=0;e<f.length;e++)if(!f[e].equals(c[e]))throw u.default.error(`Illegal argument type (expected ${f[e]}): ${c[e]}`,s);super(null,!1,null,t.type.right,s),this.subject=t,this.antecedents=e;var h=t.expand();if(!(h instanceof g.default))throw u.default.error("Assertion failed",s);this.requiredAntecedents=h.left,this.antecedentEqualsResults=Array(h.left.length).fill(0).map((()=>[]));var $=e.map((e=>e.expand()));for(let t=0;t<h.left.length;t++){if(!(_=h.left[t].equals($[t],n)))throw u.default.error(`LHS #${t+1} failed to match:\n\n--- EXPECTED ---\n${h.left[t].expand()}\n----------------\n\n--- RECEIVED ---\n${e[t].expand()}\n----------------`,s);this.antecedentEqualsResults[t]=_}if(this.preFormatConsequent=h.right,a){var _;if(!(_=h.right.equals(a,n)))throw u.default.error(`RHS failed to match:\n\n--- EXPECTED ---\n${h.right.expand()}\n----------------\n\n--- RECEIVED (from [as ...]) ---\n${a.expand()}\n----------------`,s);this.rightEqualsResult=_,this.consequent=a}else this.consequent=h.right}isProvedInternal(e){return this.subject.isProved(e)&&this.antecedents.every((t=>t.isProved(e)))}substitute(e){return this.consequent.substitute(e)}expandInternal(){return this.consequent.expand()}getEqualsPriority(){return u.EqualsPriority.FIVE}equalsInternal(e,t){return this.consequent.equals(e,t)}getProofInternal(e,t,r){var a,n=[],s=this.antecedents.map(((a,s)=>{if(!this.antecedentEqualsResults[s].length){if(e.has(a))return e.get(a);if(t.has(a))return t.get(a)}var p=e.has(a)?e.get(a):t.has(a)?t.get(a):null,i=p?[]:a.getProof(e,t,r);return this.antecedentEqualsResults[s].length&&i.push({_type:"bydef",ctr:r.next(),ref:p||i[i.length-1].ctr,expr:this.requiredAntecedents[s],of:this.antecedentEqualsResults[s]}),n.push(i),this.antecedentEqualsResults[s].length?r.peek():i[i.length-1].ctr})),p=null,i=[],u=e.get(this.subject)||t.get(this.subject)||!!(this.subject instanceof o.default&&t.has(this.subject.fun))&&(p=this.subject.args,t.get(this.subject.fun))||((a=this.subject)instanceof l.default&&a.name||a instanceof o.default&&f.isNameable(a.fun)&&a.fun.name?this.subject:(i=this.subject.getProof(e,t,r))[i.length-1].ctr),c=[...n.flat(),...i];return this.rightEqualsResult&&this.rightEqualsResult.length?c.push({_type:"TE",ctr:r.next(),subject:u,args:p,antecedents:s,reduced:this.preFormatConsequent},{_type:"bydef",ref:r.peek(),ctr:r.next(),expr:this.consequent,of:this.rightEqualsResult}):c.push({_type:"TE",ctr:r.next(),subject:u,args:p,antecedents:s,reduced:this.consequent}),c}static guess(e,t,r,a,n,s,p){if(0==e.length)throw u.default.error("wut",p);var f,d;if("r"==e[0]){if(!n)throw u.default.error(`Cannot dereference @${e} (at 0): expected output is not given`,p);f=a,d=n}else{var _=Number(e[0]);if(!(1<=_&&_<=r.length))throw u.default.error(`Cannot dereference @${e} (at 0): antecedent index out of range`,p);f=t[_-1],d=r[_-1]}return function recurse(t,r,a,n){if(a=a.expand(),e.length<=t)return a;if(/^[0-9]$/.test(e[t])){var f=Number(e[t]);if(r instanceof g.default&&a instanceof g.default){if(r.left.length!=a.left.length)throw u.default.error(`Cannot dereference @${e} (at ${t}): antecedent length mismatch`,p);if(!(1<=f&&f<=a.left.length))throw u.default.error(`Cannot dereference @${e} (at ${t}): antecedent index out of range`,p);return recurse(t+1,r.left[f-1],a.left[f-1],n)}for(;;){for(;a instanceof $.default&&a.expr;)a=a.expr;if(!(r instanceof o.default&&a instanceof o.default))throw u.default.error(`Cannot dereference @${e} (at ${t})`,p);if(r.fun.equals(a.fun,s))break;if(!a.isExpandableOnce(s))throw u.default.error(`Cannot dereference @${e} (at ${t}): ${a}`,p);a=a.expandOnce(s).expanded}if(!(1<=f&&f<=a.args.length))throw u.default.error(`Cannot dereference @${e} (at ${t})`,p);return recurse(t+1,r.args[f-1],a.args[f-1],n)}if("r"==e[t]){if(!(r instanceof g.default&&a instanceof g.default))throw u.default.error(`Cannot dereference @${e} (at ${t})`,p);return recurse(t+1,r.right,a.right,n)}if("c"==e[t]){if(!(r instanceof l.default&&!r.name&&a instanceof l.default)||a.name)throw u.default.error(`Cannot dereference @${e} (at ${t})`,p);if(r.length!=a.length)throw u.default.error(`Cannot dereference @${e} (at ${t}): parameter length mismatch`,p);for(var d=[],_=0;_<r.length;_++){if(!r.params[_].type.equals(a.params[_].type))throw u.default.error(`Cannot dereference @${e} (at ${t}): parameter type mismatch`,p);d.push(new c.default({tex:a.params[_].tex,type:r.params[_].type,name:a.params[_].name,selector:null},p))}return recurse(t+1,r.call(d),a.call(d),d.concat(n))}if("f"==e[t]){if(t!=e.length-1)throw u.default.error(`Cannot dereference @${e} (at ${t}): invalid selector`,p);return a instanceof o.default&&a.args.length==n.length&&a.args.every(((e,t)=>e==n[t]))?a.fun:new h.default({doc:null,tex:null,annotations:[],schemaType:"schema",name:null,params:n,context:new i.default,def$s:[],expr:a},p)}throw u.default.error(`Cannot dereference @${e} (at ${t}): invalid selector`,p)}(1,f,d,[])}toIndentedString(e,t){var r=this.antecedents.map((t=>t.toIndentedString(e+1)));return r.join("").length<=50?(r=this.antecedents.map((t=>t.toIndentedString(e))),[this.subject.toIndentedString(e)+"[",r.join(", "),"]"].join("")):[this.subject.toIndentedString(e)+"[","\t"+r.join(",\n"+"\t".repeat(e+1)),"]"].join("\n"+"\t".repeat(e))}toTeXString(e,t){return`${this.subject.toTeXString(!1)}[${this.antecedents.map((e=>e.toTeXString(u.default.PREC_COMMA))).join(", ")}]`}}t.default=Reduction},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(0));class With extends n.default{constructor({variable:e,def$s:t,expr:r},a){super(null,!1,null,r.type,a),this.variable=e,this.def$s=t,this.expr=r}substitute(e){return e.has(this.variable)&&(e=new Map(e)).delete(this.variable),this.expand().substitute(e)}expandInternal(){var e=new Map;return e.set(this.variable,this.variable.expr),this.expr.substitute(e).expand()}getEqualsPriority(e){throw new Error("Method not implemented.")}equalsInternal(e,t){throw new Error("Method not implemented.")}isProvedInternal(e){return this.expr.isProved(e)}getProofInternal(e,t,r,a){return t=new Map(t),[{_type:"def",ctr:r.next(),var:this.variable},...this.def$s.map((a=>{var n=a.expr.getProof(e,t,r),s=n[n.length-1].ctr;return t.set(a,s),n})).flat(1),...this.expr.getProof(e,t,r)]}toIndentedString(e,t){throw new Error("Method not implemented.")}toTeXString(e,t){throw new Error("Method not implemented.")}}t.default=With},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(18)),s=a(r(3));t.default=class ProofExplorer{static get(e,t,r,a){var p="<b>R</b>",i="<b>↦E</b>";if(!e.hasSchema(t))throw Error("wut");var l=e.getSchema(t);if(!(l instanceof s.default))throw Error("wut");function getHtmlLine(e,t,a,n,s){for(var p=t.length,{bbb:i=!1,rrb:l=!1}=s||{},o=t.map(((e,t,a)=>`<td class="${l&&t==a.length-1?"rrb":"brb"}">${e.map((e=>r(e.toTeXStringWithId(!0)))).join(", ")}</td>`)).join(""),u=0;u<t.length;u++)for(;t[u].length;)t[u].pop();return`<tr><th>${e}</th>${o}<td ${i?'class="bbb" ':""}colspan="${f-p}">${a}</td>${n instanceof Array?n.map(((e,t)=>`<td${0==t?' style="text-align:center"':""}>${e}</td>`)).join(""):`<td colspan="2">${n}</td>`}</tr>`}function exprToHtml(e,t){return"number"==typeof e?`<b>${e}</b>`:e instanceof Array?`<b>${e[0]}&ndash;${e[1]}</b>`:r(t?e.expand().toTeXString(!0,!0):e.toTeXString(!0,!0))}var o=l.getProof(new Map,new Map,new n.default,!0),u=o[0].$lines.concat(o[0].lines),f=function recurse(e){return Math.max(...e.map((e=>{switch(e._type){case"V":return Math.max(recurse(e.$lines),recurse(e.lines))+1;case"T":return Math.max(recurse(e.leftlines),recurse(e.rightlines))+1;default:return 1}})))}(u),c='<table class="explorer">';return c+=`<tr><th>#</th><th colspan="${f}">expression</th><th colspan="2">rule</th></tr>`,c+=function tree2html(e,t){return e.map((e=>{switch(e._type){case"V":var r=e.params.slice();return tree2html(e.$lines,t.concat([r]))+tree2html(e.lines,t.concat([r]));case"T":var n=t.concat([[]]),s="";if(0==e.leftlines.length)s+=getHtmlLine("",Array(t.length+1).fill([]),"","",{bbb:!0,rrb:!0});else s+=e.leftlines.map(((e,t,r)=>getHtmlLine(e.ctr,n,exprToHtml(e.expr,!0),"assumption",{bbb:t==r.length-1,rrb:!0}))).join("");return s+=tree2html(e.rightlines,n);case"?":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),"???");case"H":throw Error("no");case"R":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),[p,exprToHtml(e.num)]);case"RS":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),[p,exprToHtml(e.expr)]);case"RC":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),[i,exprToHtml(e.expr)]);case"SE":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),[i,`${exprToHtml(e.schema)} (${e.args.map((e=>exprToHtml(e))).join(", ")})`]);case"TE":return getHtmlLine(e.ctr,t,exprToHtml(e.reduced,!0),["<b>⊢E</b>",`${exprToHtml(e.subject)}${e.args?" ("+e.args.map((e=>exprToHtml(e))).join(", ")+")":""} [${e.antecedents.map((e=>exprToHtml(e))).join(", ")}]`]);case"NP":return getHtmlLine(e.ctr,t,exprToHtml(e.expr,!0),'<b class="red">not proved</b>');case"def":return getHtmlLine(e.ctr,t,e.var.doc?`<p>${exprToHtml(e.var)}</p>${a.render(e.var.doc)}`:exprToHtml(e.var),"definition");case"bydef":return getHtmlLine(e.ctr,t,exprToHtml(e.expr),`by definition of ${e.of.map((e=>exprToHtml(e))).join(", ")} [${exprToHtml(e.ref)}]`);default:throw Error("Unknown type "+e._type)}})).join("")}(u,[]),c+="</table>"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class Counter{constructor(e=0){this.n=e}peek(){return this.n}next(){return++this.n}}},function(e,t,r){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=a(r(5)),s=a(r(2)),p=a(r(8)),i=r(1),l=a(r(4)),o=a(r(20));class Scope{constructor(e,t,r){if(this.importMap=new Map,this.typedefMap=new Map,this.defMap=new Map,this.schemaMap=new Map,this.$Map=new Map,this.hypotheses=[],this.fileUri=e,this.parent=t,this.root=t?t.root:this,r&&!(r instanceof o.default))throw Error("Assertion failed");this.trace=r||new o.default(e)}extend(e,t,r){var a=new Scope(this.fileUri,this,this.trace.extend({type:e,name:t,location:r}));return this.hypotheses.forEach((e=>a.hypotheses.push(e))),a}error(e){return this.trace.error(e)}hasOwnType(e){if("string"==typeof e)return this.typedefMap.has(e)||[...this.importMap.values()].some((t=>t.hasOwnType(e)));if(!(e instanceof Array))throw this.error("Argument is malformed");if(e.length<2)throw this.error("Illegal array length");return e.map((e=>this.hasOwnType(e))).every((e=>e))}hasType(e){if("string"==typeof e)return this.hasOwnType(e)||!!this.parent&&this.parent.hasType(e);if(!(e instanceof Array))throw this.error("Argument is malformed");if(e.length<2)throw this.error("Illegal array length");return e.map((e=>this.hasType(e))).every((e=>e))}addType(e){if(!(e instanceof i.SimpleObjectType))throw this.error("Illegal argument type");if(!e.name)throw this.error("Something's wrong");if(this.hasOwnType(e.name))throw this.error(`Type ${e.name} has already been declared`);return this.typedefMap.set(e.name,e),e}getType(e){if("string"==typeof e){if(!this.hasType(e))throw this.error(`Type ${e} is not defined`);return this.typedefMap.has(e)?this.typedefMap.get(e):!!this.parent&&this.parent.getType(e)||[...this.importMap.values()].filter((t=>t.hasType(e)))[0].getType(e)}if(!(e instanceof Array))throw this.error("Argument is malformed");if(e.length<2)throw this.error("Illegal array length");var t=e.slice(0,e.length-1).map((e=>this.getType(e))),r=this.getType(e[e.length-1]);return new i.FunctionalObjectType({from:t,to:r},this.trace)}hasOwnVariable(e){return this.defMap.has(e)||[...this.importMap.values()].some((t=>t.hasOwnVariable(e)))}hasVariable(e){return this.hasOwnVariable(e)||!!this.parent&&this.parent.hasVariable(e)}addVariable(e){if(!(e instanceof l.default))throw this.error("Illegal argument type");if(this.hasOwnVariable(e.name))throw this.error(`Definition ${e.name} has already been declared`);return this.defMap.set(e.name,e),e}addFun(e){if(!(e instanceof p.default))throw this.error("Illegal argument type");if(!e.name)throw this.error("Cannot add anonymous fun to scope");if(this.hasOwnVariable(e.name))throw this.error(`Definition ${e.name} has already been declared`);return this.defMap.set(e.name,e),e}getVariable(e){if(!this.hasVariable(e))throw this.error(`Definition ${e} is not defined`);return this.defMap.has(e)?this.defMap.get(e):!!this.parent&&this.parent.getVariable(e)||[...this.importMap.values()].filter((t=>t.hasVariable(e)))[0].getVariable(e)}hasOwnSchema(e){return this.schemaMap.has(e)||this.defMap.has(e)||[...this.importMap.values()].some((t=>t.hasOwnSchema(e)))}hasSchema(e){return this.hasOwnSchema(e)||!!this.parent&&this.parent.hasSchema(e)}addSchema(e){if(!(e instanceof s.default))throw this.error("Illegal argument type");if(this.hasOwnSchema(e.name))throw this.error(`Schema ${e.name} has already been declared`);return this.schemaMap.set(e.name,e),e}getSchema(e){if(!this.hasSchema(e))throw this.error(`Schema ${e} is not defined`);return this.schemaMap.has(e)?this.schemaMap.get(e):this.defMap.has(e)?this.defMap.get(e):!!this.parent&&this.parent.getSchema(e)||[...this.importMap.values()].filter((t=>t.hasSchema(e)))[0].getSchema(e)}hasOwn$(e){return this.$Map.has(e)||[...this.importMap.values()].some((t=>t.hasOwn$(e)))}has$(e){return this.hasOwn$(e)||!!this.parent&&this.parent.has$(e)}add$(e){if(!(e instanceof n.default))throw this.error("Illegal argument type");if(this.hasOwn$(e.name))throw this.error(`$ variable ${e.name} has already been declared`);return this.$Map.set(e.name,e),e}get$(e){if(!this.has$(e))throw this.error(`$ variable ${e} is not defined`);return this.$Map.has(e)?this.$Map.get(e):!!this.parent&&this.parent.get$(e)||[...this.importMap.values()].filter((t=>t.has$(e)))[0].get$(e)}}t.default=Scope},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class StackTrace{constructor(e,t){this.fileUri=e,this.stack=t||[]}extend(e){return new StackTrace(this.fileUri,[e].concat(this.stack))}error(e){var t=this.fileUri||"<unknown>";return new Error(e+"\n\tat "+(this.stack.length?this.stack.map((({type:e,name:r,location:a})=>`${e} ${r||"<anonymous>"} (${t}:${a.start.line}:${a.start.column})`)).join("\n\tat "):`<root> (${t}:1:1)`))}}t.default=StackTrace},function(e,t,r){"use strict";function peg$SyntaxError(e,t,r,a){this.message=e,this.expected=t,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}!function peg$subclass(e,t){function ctor(){this.constructor=e}ctor.prototype=t.prototype,e.prototype=new ctor}(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(e,t){var r={literal:function(e){return'"'+literalEscape(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?classEscape(e.parts[t][0])+"-"+classEscape(e.parts[t][1]):classEscape(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function hex(e){return e.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}function classEscape(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}return"Expected "+function describeExpected(e){var t,a,n,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(n=e[t],r[n.type](n));if(s.sort(),s.length>0){for(t=1,a=1;t<s.length;t++)s[t-1]!==s[t]&&(s[a]=s[t],a++);s.length=a}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function describeFound(e){return e?'"'+literalEscape(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:peg$SyntaxError,parse:function peg$parse(e,t){t=void 0!==t?t:{};var r,a={},n={start:peg$parsestart},s=peg$parsestart,peg$c1=function(e,t){return t},p="import",i=peg$literalExpectation("import",!1),l="type",o=peg$literalExpectation("type",!1),u="=",f=peg$literalExpectation("=",!1),c="sealed",h=peg$literalExpectation("sealed",!1),g=peg$literalExpectation(":",!1),d=peg$literalExpectation("@",!1),$=/^[a-z0-9_]/,_=peg$classExpectation([["a","z"],["0","9"],"_"],!1,!1),x="(",m=peg$literalExpectation("(",!1),y=",",b=peg$literalExpectation(",",!1),peg$c31=function(e,t,r,a,n,s,p,i){return i},v=")",A=peg$literalExpectation(")",!1),P="{",w=peg$literalExpectation("{",!1),E="}",C=peg$literalExpectation("}",!1),peg$c43=function(e,t){return t},j="axiom",T=peg$literalExpectation("axiom",!1),O="theorem",S=peg$literalExpectation("theorem",!1),M="schema",I=peg$literalExpectation("schema",!1),peg$c50=function(e,t,r,a,n,s){return s},q="using",F=peg$literalExpectation("using",!1),peg$c55=function(e,t,r,a,n,s,p){return p},peg$c58=function(e,t,r,a,n,s,p){return p},k="[",R=peg$literalExpectation("[",!1),X=peg$literalExpectation(";",!1),peg$c65=function(e,t){return t},peg$c66=function(e,t){return[e].concat(t)},H="]",D=peg$literalExpectation("]",!1),V=peg$literalExpectation(">",!1),peg$c72=function(e,t){return t},N="?",L=peg$literalExpectation("?",!1),peg$c77=function(e,t,r,a){return a},peg$c78=function(e,t,r,a){return[r].concat(a)},peg$c79=function(e,t,r){return r||[]},U="as",z=peg$literalExpectation("as",!1),peg$c82=function(e,t,r,a){return a},peg$c83=function(e,t,r,a){return{subject:t,args:r,as_:a||null}},peg$c85=function(e,t,r){return r},peg$c86=function(e,t,r){return[t].concat(r)},peg$c87=function(e,t){return t||[]},peg$c90=function(e,t){return t},peg$c91=function(e){return e||[]},Q="=>",W=peg$literalExpectation("=>",!1),peg$c97=function(e,t){return t},Z=peg$literalExpectation("|-",!1),peg$c104=function(e,t){return t},B="with",G=peg$literalExpectation("with",!1),peg$c109=function(e,t,r,a,n,s){return s},peg$c113=function(e,t){return t},J=peg$literalExpectation("->",!1),K="@discouraged",Y=peg$literalExpectation("@discouraged",!1),ee="@deprecated",te=peg$literalExpectation("@deprecated",!1),re=/^[a-zA-Z0-9_]/,ae=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ne="$",se=peg$literalExpectation("$",!1),pe='"',ie=peg$literalExpectation('"',!1),le={type:"any"},peg$c132=function(e){return e.replace(/\r\n|\r/g,"\n")},oe="precedence=",ue=peg$literalExpectation("precedence=",!1),fe=/^[0-9]/,ce=peg$classExpectation([["0","9"]],!1,!1),he=peg$literalExpectation("//",!1),ge=peg$literalExpectation("/*",!1),de="*/",$e=peg$literalExpectation("*/",!1),_e=peg$literalExpectation("\r\n",!1),xe=peg$literalExpectation("\r",!1),me=peg$literalExpectation("\n",!1),ye=/^[ \t\n\r]/,be=peg$classExpectation([" ","\t","\n","\r"],!1,!1),ve=0,Ae=0,Pe=[{line:1,column:1}],we=0,Ee=[],Ce=0,je={};if("startRule"in t){if(!(t.startRule in n))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=n[t.startRule]}function location(){return peg$computeLocation(Ae,ve)}function peg$literalExpectation(e,t){return{type:"literal",text:e,ignoreCase:t}}function peg$classExpectation(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function peg$computePosDetails(t){var r,a=Pe[t];if(a)return a;for(r=t-1;!Pe[r];)r--;for(a={line:(a=Pe[r]).line,column:a.column};r<t;)10===e.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return Pe[t]=a,a}function peg$computeLocation(e,t){var r=peg$computePosDetails(e),a=peg$computePosDetails(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:a.line,column:a.column}}}function peg$fail(e){ve<we||(ve>we&&(we=ve,Ee=[]),Ee.push(e))}function peg$buildStructuredError(e,t,r){return new peg$SyntaxError(peg$SyntaxError.buildMessage(e,t),e,t,r)}function peg$parsestart(){var e,t,r,n,s,p,i=43*ve+0,l=je[i];if(l)return ve=l.nextPos,l.result;if(e=ve,peg$parse_()!==a){for(t=[],r=ve,(n=peg$parseimport())!==a&&(s=peg$parse_())!==a?(Ae=r,r=n=n):(ve=r,r=a);r!==a;)t.push(r),r=ve,(n=peg$parseimport())!==a&&(s=peg$parse_())!==a?(Ae=r,r=n=n):(ve=r,r=a);if(t!==a){for(r=[],n=ve,(s=peg$parseline())!==a&&peg$parse_()!==a?(Ae=n,n=s=peg$c1(0,s)):(ve=n,n=a);n!==a;)r.push(n),n=ve,(s=peg$parseline())!==a&&peg$parse_()!==a?(Ae=n,n=s=peg$c1(0,s)):(ve=n,n=a);r!==a?(Ae=e,p=r,e=t.concat(p)):(ve=e,e=a)}else ve=e,e=a}else ve=e,e=a;return je[i]={nextPos:ve,result:e},e}function peg$parseline(){var e,t=43*ve+1,r=je[t];return r?(ve=r.nextPos,r.result):((e=peg$parsetypedef())===a&&(e=peg$parsedefv())===a&&(e=peg$parsedefun())===a&&(e=peg$parsedefschema()),je[t]={nextPos:ve,result:e},e)}function peg$parseimport(){var t,r,n,s=43*ve+4,l=je[s];return l?(ve=l.nextPos,l.result):(t=ve,e.substr(ve,6)===p?(r=p,ve+=6):(r=a,0===Ce&&peg$fail(i)),r!==a&&peg$parse__()!==a&&(n=peg$parseident())!==a&&peg$parse_()!==a&&peg$parsesem()!==a?(Ae=t,t=r={_type:"import",filename:n,location:location()}):(ve=t,t=a),je[s]={nextPos:ve,result:t},t)}function peg$parsetypedef(){var t,r,n,s,p,i,c,h,g,d,$,_=43*ve+5,x=je[_];return x?(ve=x.nextPos,x.result):(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a?(e.substr(ve,4)===l?(n=l,ve+=4):(n=a,0===Ce&&peg$fail(o)),n!==a&&(s=peg$parse__())!==a&&(p=peg$parseident())!==a&&peg$parse_()!==a?(i=ve,61===e.charCodeAt(ve)?(c=u,ve++):(c=a,0===Ce&&peg$fail(f)),c!==a&&peg$parse_()!==a&&(h=peg$parseftype())!==a&&peg$parse_()!==a?(Ae=i,i=c=h):(ve=i,i=a),i===a&&(i=null),i!==a&&(c=peg$parsesem())!==a?(Ae=t,d=p,$=i,t=r={_type:"typedef",doc:(g=r)?g[0]:null,expr:$,name:d,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[_]={nextPos:ve,result:t},t)}function peg$parsedefv(){var t,r,n,s,p,i,l,o,g,d,$=43*ve+6,_=je[$];return _?(ve=_.nextPos,_.result):(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a?(n=ve,(s=peg$parsetex())!==a&&(p=peg$parse__())!==a?n=s=[s,p]:(ve=n,n=a),n===a&&(n=null),n!==a?(s=ve,e.substr(ve,6)===c?(p=c,ve+=6):(p=a,0===Ce&&peg$fail(h)),p!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a&&(p=peg$parsetype())!==a&&(i=peg$parse__())!==a&&(l=peg$parseident())!==a&&peg$parse_()!==a?(o=ve,61===e.charCodeAt(ve)?(g=u,ve++):(g=a,0===Ce&&peg$fail(f)),g!==a&&peg$parse_()!==a&&(d=peg$parseobjectexpr())!==a&&peg$parse_()!==a&&peg$parsesem()!==a?(Ae=o,o=g=d):(ve=o,o=a),o===a&&(o=ve,(g=peg$parsesem())!==a&&(Ae=o,g=null),o=g),o!==a?(Ae=t,t=r=function(e,t,r,a,n,s){return{_type:"defv",isParam:!1,doc:e?e[0]:null,tex:t?t[0]:null,sealed:!!r,type:a,name:n,expr:s,location:location()}}(r,n,s,p,l,o)):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[$]={nextPos:ve,result:t},t)}function peg$parsedefparam(){var e,t,r,n,s,p,i,l,o=43*ve+7,u=je[o];return u?(ve=u.nextPos,u.result):(e=ve,t=ve,(r=peg$parsetex())!==a&&(n=peg$parse__())!==a?t=r=[r,n]:(ve=t,t=a),t===a&&(t=null),t!==a&&(r=peg$parsetype())!==a&&(n=peg$parse__())!==a&&(s=peg$parseident())!==a?(Ae=e,i=r,l=s,e=t={_type:"defv",isParam:!0,doc:null,tex:(p=t)?p[0]:null,type:i,name:l,location:location()}):(ve=e,e=a),je[o]={nextPos:ve,result:e},e)}function peg$parsedefschemaparam(){var t,r,n,s,p,i,l,o,u,f,c,h,x,m,y,b=43*ve+8,v=je[b];if(v)return ve=v.nextPos,v.result;if(t=ve,r=ve,(n=peg$parsetex())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a)if((n=peg$parsetype())!==a)if((s=peg$parse__())!==a)if((p=peg$parseident())!==a){if(i=ve,peg$parse_()!==a)if(58===e.charCodeAt(ve)?(l=":",ve++):(l=a,0===Ce&&peg$fail(g)),l!==a)if(peg$parse_()!==a)if(64===e.charCodeAt(ve)?(o="@",ve++):(o=a,0===Ce&&peg$fail(d)),o!==a){if(u=ve,f=[],$.test(e.charAt(ve))?(c=e.charAt(ve),ve++):(c=a,0===Ce&&peg$fail(_)),c!==a)for(;c!==a;)f.push(c),$.test(e.charAt(ve))?(c=e.charAt(ve),ve++):(c=a,0===Ce&&peg$fail(_));else f=a;(u=f!==a?e.substring(u,ve):f)!==a?(Ae=i,i=u):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(Ae=t,x=n,m=p,y=i,t=r={_type:"defv",isParam:!0,doc:null,tex:(h=r)?h[0]:null,type:x,name:m,selector:y,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[b]={nextPos:ve,result:t},t}function peg$parsedefun(){var t,r,n,s,p,i,l,o,u,f,g,d,$,_,j,T,O,S=43*ve+9,M=je[S];if(M)return ve=M.nextPos,M.result;if(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a)if(n=ve,(s=function peg$parsetex_attributes(){var t,r,n,s,p,i,l=43*ve+36,o=je[l];if(o)return ve=o.nextPos,o.result;t=ve,91===e.charCodeAt(ve)?(r=k,ve++):(r=a,0===Ce&&peg$fail(R));if(r!==a)if(peg$parse_()!==a)if(e.substr(ve,11)===oe?(n=oe,ve+=11):(n=a,0===Ce&&peg$fail(ue)),n!==a)if(peg$parse_()!==a){if(s=ve,p=[],fe.test(e.charAt(ve))?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(ce)),i!==a)for(;i!==a;)p.push(i),fe.test(e.charAt(ve))?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(ce));else p=a;(s=p!==a?e.substring(s,ve):p)!==a&&(p=peg$parse_())!==a?(93===e.charCodeAt(ve)?(i=H,ve++):(i=a,0===Ce&&peg$fail(D)),i!==a?(Ae=t,t=r={precedence:1*s}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[l]={nextPos:ve,result:t},t}())!==a&&(p=peg$parse__())!==a?n=s=[s,p]:(ve=n,n=a),n===a&&(n=null),n!==a)if(s=ve,(p=peg$parsetex())!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a)if(p=ve,e.substr(ve,6)===c?(i=c,ve+=6):(i=a,0===Ce&&peg$fail(h)),i!==a&&(l=peg$parse__())!==a?p=i=[i,l]:(ve=p,p=a),p===a&&(p=null),p!==a)if((i=peg$parsetype())!==a)if((l=peg$parse__())!==a)if((o=peg$parseident())!==a)if(peg$parse_()!==a){if(u=ve,40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((g=peg$parse_())!==a){if(d=ve,($=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(_=[],j=ve,44===e.charCodeAt(ve)?(T=y,ve++):(T=a,0===Ce&&peg$fail(b)),T!==a&&peg$parse_()!==a&&(O=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=j,j=T=peg$c31(0,0,0,0,0,0,0,O)):(ve=j,j=a);j!==a;)_.push(j),j=ve,44===e.charCodeAt(ve)?(T=y,ve++):(T=a,0===Ce&&peg$fail(b)),T!==a&&peg$parse_()!==a&&(O=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=j,j=T=peg$c31(0,0,0,0,0,0,0,O)):(ve=j,j=a);_!==a?(Ae=d,d=$=[$].concat(_)):(ve=d,d=a)}else ve=d,d=a;else ve=d,d=a;d===a&&(d=null),d!==a?(41===e.charCodeAt(ve)?($=v,ve++):($=a,0===Ce&&peg$fail(A)),$!==a&&peg$parse_()!==a?(Ae=u,u=f=d||[]):(ve=u,u=a)):(ve=u,u=a)}else ve=u,u=a;else ve=u,u=a;u!==a?(f=ve,123===e.charCodeAt(ve)?(g=P,ve++):(g=a,0===Ce&&peg$fail(w)),g!==a&&(d=peg$parse_())!==a&&($=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(_=E,ve++):(_=a,0===Ce&&peg$fail(C)),_!==a?(Ae=f,f=g=$):(ve=f,f=a)):(ve=f,f=a),f===a&&(f=ve,(g=peg$parsesem())!==a&&(Ae=f,g=null),f=g),f!==a?(Ae=t,t=r=function(e,t,r,a,n,s,p,i){return{_type:"defun",doc:e?e[0]:null,tex_attributes:t?t[0]:{precedence:!1},tex:r?r[0]:null,sealed:!!a,rettype:n,name:s,params:p,expr:i,location:location()}}(r,n,s,p,i,o,u,f)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[S]={nextPos:ve,result:t},t}function peg$parsedefschema(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d,$,_,k,R,X,H,D,V,N,L,U,z,Q=43*ve+10,W=je[Q];if(W)return ve=W.nextPos,W.result;if(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a){for(n=[],s=ve,(p=peg$parseannotation())!==a&&(i=peg$parse__())!==a?(Ae=s,s=p=peg$c43(0,p)):(ve=s,s=a);s!==a;)n.push(s),s=ve,(p=peg$parseannotation())!==a&&(i=peg$parse__())!==a?(Ae=s,s=p=peg$c43(0,p)):(ve=s,s=a);if(n!==a)if(e.substr(ve,5)===j?(s=j,ve+=5):(s=a,0===Ce&&peg$fail(T)),s===a&&(e.substr(ve,7)===O?(s=O,ve+=7):(s=a,0===Ce&&peg$fail(S)),s===a&&(e.substr(ve,6)===M?(s=M,ve+=6):(s=a,0===Ce&&peg$fail(I)))),s!==a)if((p=peg$parse__())!==a)if((i=peg$parseident())!==a)if(peg$parse_()!==a){if(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a)if((u=peg$parse_())!==a){if(f=ve,(c=peg$parsedefschemaparam())!==a)if((h=peg$parse_())!==a){for(g=[],d=ve,44===e.charCodeAt(ve)?($=y,ve++):($=a,0===Ce&&peg$fail(b)),$!==a&&(_=peg$parse_())!==a&&(k=peg$parsedefschemaparam())!==a&&(R=peg$parse_())!==a?(Ae=d,d=$=peg$c50(0,0,0,0,0,k)):(ve=d,d=a);d!==a;)g.push(d),d=ve,44===e.charCodeAt(ve)?($=y,ve++):($=a,0===Ce&&peg$fail(b)),$!==a&&(_=peg$parse_())!==a&&(k=peg$parsedefschemaparam())!==a&&(R=peg$parse_())!==a?(Ae=d,d=$=peg$c50(0,0,0,0,0,k)):(ve=d,d=a);g!==a?(Ae=f,f=c=[c].concat(g)):(ve=f,f=a)}else ve=f,f=a;else ve=f,f=a;f===a&&(f=null),f!==a?(41===e.charCodeAt(ve)?(c=v,ve++):(c=a,0===Ce&&peg$fail(A)),c!==a&&(h=peg$parse_())!==a?(Ae=l,l=o=f||[]):(ve=l,l=a)):(ve=l,l=a)}else ve=l,l=a;else ve=l,l=a;if(l!==a){if(o=ve,e.substr(ve,5)===q?(u=q,ve+=5):(u=a,0===Ce&&peg$fail(F)),u!==a)if((f=peg$parse__())!==a){if(c=ve,(h=peg$parseident())!==a)if((g=peg$parse_())!==a){for(d=[],$=ve,44===e.charCodeAt(ve)?(_=y,ve++):(_=a,0===Ce&&peg$fail(b)),_!==a&&(k=peg$parse_())!==a&&(R=peg$parseident())!==a&&peg$parse_()!==a?(Ae=$,$=_=peg$c55(0,0,0,0,0,0,R)):(ve=$,$=a);$!==a;)d.push($),$=ve,44===e.charCodeAt(ve)?(_=y,ve++):(_=a,0===Ce&&peg$fail(b)),_!==a&&(k=peg$parse_())!==a&&(R=peg$parseident())!==a&&peg$parse_()!==a?(Ae=$,$=_=peg$c55(0,0,0,0,0,0,R)):(ve=$,$=a);d!==a?(Ae=c,c=h=function(e,t,r,a,n,s,p){return[s].concat(p)}(0,0,0,0,0,h,d)):(ve=c,c=a)}else ve=c,c=a;else ve=c,c=a;c!==a?(Ae=o,o=u=c):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;if(o===a&&(o=null),o!==a)if(123===e.charCodeAt(ve)?(u=P,ve++):(u=a,0===Ce&&peg$fail(w)),u!==a)if((f=peg$parse_())!==a){for(c=[],h=ve,(g=peg$parsedefdollar())!==a&&(d=peg$parse_())!==a?(Ae=h,h=g=peg$c58(0,0,0,0,0,0,g)):(ve=h,h=a);h!==a;)c.push(h),h=ve,(g=peg$parsedefdollar())!==a&&(d=peg$parse_())!==a?(Ae=h,h=g=peg$c58(0,0,0,0,0,0,g)):(ve=h,h=a);c!==a&&(h=peg$parse_())!==a&&(g=peg$parseexpr_internal_3())!==a&&(d=peg$parse_())!==a?(125===e.charCodeAt(ve)?($=E,ve++):($=a,0===Ce&&peg$fail(C)),$!==a?(Ae=t,H=n,D=s,V=i,N=l,L=o,U=c,z=g,t=r={_type:"defschema",doc:(X=r)?X[0]:null,annotations:H,schemaType:D,name:V,params:N,using:L||[],def$s:U,expr:z,location:location()}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a}else ve=t,t=a}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a}else ve=t,t=a;return je[Q]={nextPos:ve,result:t},t}function peg$parsereduction(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d,$,_,P,w,E,C=43*ve+11,j=je[C];if(j)return ve=j.nextPos,j.result;if(t=ve,r=ve,(n=peg$parseexpr_internal_2())!==a&&(Ae=r,n=[n]),(r=n)===a)if(r=ve,91===e.charCodeAt(ve)?(n=k,ve++):(n=a,0===Ce&&peg$fail(R)),n!==a)if((s=peg$parse_())!==a){if(p=ve,(i=peg$parseexpr_internal_3())!==a)if(peg$parse_()!==a){for(l=[],o=ve,59===e.charCodeAt(ve)?(u=";",ve++):(u=a,0===Ce&&peg$fail(X)),u!==a&&(f=peg$parse_())!==a&&(c=peg$parseexpr_internal_3())!==a&&(h=peg$parse_())!==a?(Ae=o,o=u=peg$c65(0,c)):(ve=o,o=a);o!==a;)l.push(o),o=ve,59===e.charCodeAt(ve)?(u=";",ve++):(u=a,0===Ce&&peg$fail(X)),u!==a&&(f=peg$parse_())!==a&&(c=peg$parseexpr_internal_3())!==a&&(h=peg$parse_())!==a?(Ae=o,o=u=peg$c65(0,c)):(ve=o,o=a);l!==a?(Ae=p,p=i=peg$c66(i,l)):(ve=p,p=a)}else ve=p,p=a;else ve=p,p=a;p===a&&(p=null),p!==a?(93===e.charCodeAt(ve)?(i=H,ve++):(i=a,0===Ce&&peg$fail(D)),i!==a?(Ae=r,r=n=p||[]):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;if(r!==a){if(n=[],s=ve,(p=peg$parse_())!==a)if(62===e.charCodeAt(ve)?(i=">",ve++):(i=a,0===Ce&&peg$fail(V)),i!==a)if(peg$parse_()!==a)if((l=peg$parseschemacall())===a&&(l=peg$parsevar())===a&&(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&(c=peg$parse_())!==a?(41===e.charCodeAt(ve)?(h=v,ve++):(h=a,0===Ce&&peg$fail(A)),h!==a?(Ae=l,l=o=peg$c72(0,f)):(ve=l,l=a)):(ve=l,l=a)),l!==a){if(o=ve,(u=peg$parse_())!==a)if(40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((c=peg$parse_())!==a){if(h=ve,g=ve,63===e.charCodeAt(ve)?(d=N,ve++):(d=a,0===Ce&&peg$fail(L)),d!==a&&(Ae=g,d=null),(g=d)===a&&(g=peg$parseobjectexpr()),g!==a)if((d=peg$parse_())!==a){for($=[],_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);_!==a;)$.push(_),_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);$!==a?(Ae=h,h=g=peg$c78(0,0,g,$)):(ve=h,h=a)}else ve=h,h=a;else ve=h,h=a;h===a&&(h=null),h!==a?(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a?(Ae=o,o=u=peg$c79(0,0,h)):(ve=o,o=a)):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;else ve=o,o=a;o===a&&(o=null),o!==a?(u=ve,(f=peg$parse__())!==a?(e.substr(ve,2)===U?(c=U,ve+=2):(c=a,0===Ce&&peg$fail(z)),c!==a&&(h=peg$parse__())!==a&&(g=peg$parseexpr_internal_2())!==a?(Ae=u,u=f=peg$c82(0,0,0,g)):(ve=u,u=a)):(ve=u,u=a),u===a&&(u=null),u!==a?(Ae=s,s=p=peg$c83(0,l,o,u)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;if(s!==a)for(;s!==a;)if(n.push(s),s=ve,(p=peg$parse_())!==a)if(62===e.charCodeAt(ve)?(i=">",ve++):(i=a,0===Ce&&peg$fail(V)),i!==a)if(peg$parse_()!==a)if((l=peg$parseschemacall())===a&&(l=peg$parsevar())===a&&(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&(c=peg$parse_())!==a?(41===e.charCodeAt(ve)?(h=v,ve++):(h=a,0===Ce&&peg$fail(A)),h!==a?(Ae=l,l=o=peg$c72(0,f)):(ve=l,l=a)):(ve=l,l=a)),l!==a){if(o=ve,(u=peg$parse_())!==a)if(40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((c=peg$parse_())!==a){if(h=ve,g=ve,63===e.charCodeAt(ve)?(d=N,ve++):(d=a,0===Ce&&peg$fail(L)),d!==a&&(Ae=g,d=null),(g=d)===a&&(g=peg$parseobjectexpr()),g!==a)if((d=peg$parse_())!==a){for($=[],_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);_!==a;)$.push(_),_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);$!==a?(Ae=h,h=g=peg$c78(0,0,g,$)):(ve=h,h=a)}else ve=h,h=a;else ve=h,h=a;h===a&&(h=null),h!==a?(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a?(Ae=o,o=u=peg$c79(0,0,h)):(ve=o,o=a)):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;else ve=o,o=a;o===a&&(o=null),o!==a?(u=ve,(f=peg$parse__())!==a?(e.substr(ve,2)===U?(c=U,ve+=2):(c=a,0===Ce&&peg$fail(z)),c!==a&&(h=peg$parse__())!==a&&(g=peg$parseexpr_internal_2())!==a?(Ae=u,u=f=peg$c82(0,0,0,g)):(ve=u,u=a)):(ve=u,u=a),u===a&&(u=null),u!==a?(Ae=s,s=p=peg$c83(0,l,o,u)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else n=a;n!==a?(Ae=t,t=r=function(e,t){for(var r={_type:"reduction",subject:t[0].subject,args:t[0].args,antecedents:e,as:t[0].as_,location:location()},a=1;a<t.length;a++)r={_type:"reduction",subject:t[a].subject,args:t[a].args,antecedents:[r],as:t[a].as_,location:location()};return r}(r,n)):(ve=t,t=a)}else ve=t,t=a;return je[C]={nextPos:ve,result:t},t}function peg$parseschemacall(){var t,r,n,s,p,i,l,o,u,f,c,h=43*ve+12,g=je[h];if(g)return ve=g.nextPos,g.result;if(t=ve,(r=peg$parsevar())===a&&(r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a&&(s=peg$parse_())!==a&&(p=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(i=v,ve++):(i=a,0===Ce&&peg$fail(A)),i!==a?(Ae=r,r=n=p):(ve=r,r=a)):(ve=r,r=a)),r!==a)if((n=peg$parse_())!==a){if(s=ve,40===e.charCodeAt(ve)?(p=x,ve++):(p=a,0===Ce&&peg$fail(m)),p!==a)if(peg$parse_()!==a){if(i=ve,(l=peg$parseobjectexpr())!==a)if(peg$parse_()!==a){for(o=[],u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);u!==a;)o.push(u),u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);o!==a?(Ae=i,i=l=peg$c86(0,l,o)):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(41===e.charCodeAt(ve)?(l=v,ve++):(l=a,0===Ce&&peg$fail(A)),l!==a?(Ae=s,s=p=peg$c87(0,i)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"schemacall",schema:r,args:s,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[h]={nextPos:ve,result:t},t}function peg$parsefuncall(){var t,r,n,s,p,i,l,o,u,f,c,h=43*ve+13,g=je[h];if(g)return ve=g.nextPos,g.result;if(t=ve,(r=peg$parsevar())===a&&(r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a&&(s=peg$parse_())!==a&&(p=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(i=v,ve++):(i=a,0===Ce&&peg$fail(A)),i!==a?(Ae=r,r=n=p):(ve=r,r=a)):(ve=r,r=a)),r!==a)if((n=peg$parse_())!==a){if(s=ve,40===e.charCodeAt(ve)?(p=x,ve++):(p=a,0===Ce&&peg$fail(m)),p!==a)if(peg$parse_()!==a){if(i=ve,(l=peg$parseobjectexpr())!==a)if(peg$parse_()!==a){for(o=[],u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);u!==a;)o.push(u),u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);o!==a?(Ae=i,i=l=peg$c86(0,l,o)):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(41===e.charCodeAt(ve)?(l=v,ve++):(l=a,0===Ce&&peg$fail(A)),l!==a?(Ae=s,s=p=peg$c87(0,i)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"funcall",schema:r,args:s,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[h]={nextPos:ve,result:t},t}function peg$parsefunexpr(){var t,r,n,s,p,i,l,o,u,f=43*ve+14,c=je[f];if(c)return ve=c.nextPos,c.result;if(t=ve,r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);i!==a?(Ae=s,s=p=peg$c66(p,i)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s===a&&(s=null),s!==a?(41===e.charCodeAt(ve)?(p=v,ve++):(p=a,0===Ce&&peg$fail(A)),p!==a&&peg$parse_()!==a?(Ae=r,r=n=peg$c91(s)):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;return r!==a?(e.substr(ve,2)===Q?(n=Q,ve+=2):(n=a,0===Ce&&peg$fail(W)),n!==a&&peg$parse_()!==a?((s=peg$parseobjectexpr())===a&&(s=ve,123===e.charCodeAt(ve)?(p=P,ve++):(p=a,0===Ce&&peg$fail(w)),p!==a&&peg$parse_()!==a&&(i=peg$parseobjectexpr())!==a&&(l=peg$parse_())!==a?(125===e.charCodeAt(ve)?(o=E,ve++):(o=a,0===Ce&&peg$fail(C)),o!==a?(Ae=s,s=p=i):(ve=s,s=a)):(ve=s,s=a)),s!==a?(Ae=t,t=r={_type:"funexpr",params:r,expr:s,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[f]={nextPos:ve,result:t},t}function peg$parseschemaexpr(){var t,r,n,s,p,i,l,o,u,f,c=43*ve+15,h=je[c];if(h)return ve=h.nextPos,h.result;if(t=ve,r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);i!==a?(Ae=s,s=p=peg$c66(p,i)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s===a&&(s=null),s!==a?(41===e.charCodeAt(ve)?(p=v,ve++):(p=a,0===Ce&&peg$fail(A)),p!==a&&peg$parse_()!==a?(Ae=r,r=n=peg$c91(s)):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;if(r!==a)if(e.substr(ve,2)===Q?(n=Q,ve+=2):(n=a,0===Ce&&peg$fail(W)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parseexpr_internal_1())!==a&&(Ae=s,p={defdollars:[],expr:p}),(s=p)===a)if(s=ve,123===e.charCodeAt(ve)?(p=P,ve++):(p=a,0===Ce&&peg$fail(w)),p!==a)if(peg$parse_()!==a){for(i=[],l=ve,(o=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c97(0,o)):(ve=l,l=a);l!==a;)i.push(l),l=ve,(o=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c97(0,o)):(ve=l,l=a);i!==a&&(l=peg$parse_())!==a&&(o=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(u=E,ve++):(u=a,0===Ce&&peg$fail(C)),u!==a?(Ae=s,s=p=function(e,t,r){return{defdollars:t,expr:r}}(0,i,o)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"schemaexpr",params:r,def$s:(f=s).defdollars,expr:f.expr,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[c]={nextPos:ve,result:t},t}function peg$parsetee(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d=43*ve+16,$=je[d];if($)return ve=$.nextPos,$.result;if(t=ve,r=ve,n=ve,(s=peg$parseexpr_internal_1())!==a)if((p=peg$parse_())!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_1())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c65(0,f)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_1())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c65(0,f)):(ve=l,l=a);i!==a?(Ae=n,n=s=peg$c66(s,i)):(ve=n,n=a)}else ve=n,n=a;else ve=n,n=a;if(n===a&&(n=null),n!==a&&(Ae=r,n=n||[]),(r=n)!==a)if("|-"===e.substr(ve,2)?(n="|-",ve+=2):(n=a,0===Ce&&peg$fail(Z)),n!==a)if((s=peg$parse_())!==a){if(p=ve,(i=peg$parseexpr_internal_2())!==a&&(Ae=p,i={defdollars:[],expr:i}),(p=i)===a)if(p=ve,123===e.charCodeAt(ve)?(i=P,ve++):(i=a,0===Ce&&peg$fail(w)),i!==a)if((l=peg$parse_())!==a){for(o=[],u=ve,(f=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c104(0,f)):(ve=u,u=a);u!==a;)o.push(u),u=ve,(f=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c104(0,f)):(ve=u,u=a);o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(c=E,ve++):(c=a,0===Ce&&peg$fail(C)),c!==a?(Ae=p,p=i=function(e,t,r){return{defdollars:t,expr:r}}(0,o,f)):(ve=p,p=a)):(ve=p,p=a)}else ve=p,p=a;else ve=p,p=a;p!==a?(Ae=t,h=r,t=r={_type:"tee",def$s:(g=p).defdollars,left:h,right:g.expr,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[d]={nextPos:ve,result:t},t}function peg$parsewith(){var t,r,n,s,p,i,l,o,c,h,g,d,$,_,y,b,j,T,O,S,M,I,q,F=43*ve+17,k=je[F];if(k)return ve=k.nextPos,k.result;if(t=ve,e.substr(ve,4)===B?(r=B,ve+=4):(r=a,0===Ce&&peg$fail(G)),r!==a)if(peg$parse_()!==a)if(40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a)if(s=ve,(p=peg$parsedocumentation())!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a)if(p=ve,(i=peg$parsetex())!==a&&(l=peg$parse__())!==a?p=i=[i,l]:(ve=p,p=a),p===a&&(p=null),p!==a)if((i=peg$parsetype())!==a)if((l=peg$parse__())!==a)if((o=peg$parseident())!==a)if(peg$parse_()!==a)if(61===e.charCodeAt(ve)?(c=u,ve++):(c=a,0===Ce&&peg$fail(f)),c!==a)if(peg$parse_()!==a)if((h=peg$parseobjectexpr())!==a)if(peg$parse_()!==a)if(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a)if(peg$parse_()!==a)if(123===e.charCodeAt(ve)?(d=P,ve++):(d=a,0===Ce&&peg$fail(w)),d!==a)if(peg$parse_()!==a){for($=[],_=ve,(y=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=_,_=y=peg$c109(0,0,0,0,0,y)):(ve=_,_=a);_!==a;)$.push(_),_=ve,(y=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=_,_=y=peg$c109(0,0,0,0,0,y)):(ve=_,_=a);$!==a&&(_=peg$parse_())!==a&&(y=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(b=E,ve++):(b=a,0===Ce&&peg$fail(C)),b!==a?(Ae=t,T=p,O=i,S=o,M=h,I=$,q=y,t=r={_type:"with",with:{_type:"defv",isParam:!1,doc:(j=s)?j[0]:null,tex:T?T[0]:null,sealed:!1,type:O,name:S,expr:M,location:location()},def$s:I,expr:q,location:location()}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[F]={nextPos:ve,result:t},t}function peg$parseexpr_internal_3(){var e,t=43*ve+18,r=je[t];return r?(ve=r.nextPos,r.result):((e=peg$parsereduction())===a&&(e=peg$parseexpr_internal_2()),je[t]={nextPos:ve,result:e},e)}function peg$parseexpr_internal_2(){var e,t=43*ve+19,r=je[t];return r?(ve=r.nextPos,r.result):((e=peg$parsetee())===a&&(e=peg$parseexpr_internal_1()),je[t]={nextPos:ve,result:e},e)}function peg$parseexpr_internal_1(){var t,r,n,s,p=43*ve+20,i=je[p];return i?(ve=i.nextPos,i.result):((t=peg$parseschemacall())===a&&(t=peg$parsevar())===a&&(t=peg$parseschemaexpr())===a&&(t=peg$parsewith())===a&&(t=ve,40===e.charCodeAt(ve)?(r=x,ve++):(r=a,0===Ce&&peg$fail(m)),r!==a&&peg$parse_()!==a&&(n=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(s=v,ve++):(s=a,0===Ce&&peg$fail(A)),s!==a?(Ae=t,t=r=n):(ve=t,t=a)):(ve=t,t=a)),je[p]={nextPos:ve,result:t},t)}function peg$parseobjectexpr(){var t,r,n,s,p=43*ve+21,i=je[p];return i?(ve=i.nextPos,i.result):((t=peg$parsefuncall())===a&&(t=peg$parsefunexpr())===a&&(t=peg$parsevar())===a&&(t=ve,40===e.charCodeAt(ve)?(r=x,ve++):(r=a,0===Ce&&peg$fail(m)),r!==a&&peg$parse_()!==a&&(n=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(s=v,ve++):(s=a,0===Ce&&peg$fail(A)),s!==a?(Ae=t,t=r=n):(ve=t,t=a)):(ve=t,t=a)),je[p]={nextPos:ve,result:t},t)}function peg$parsedefdollar(){var t,r,n,s,p=43*ve+22,i=je[p];return i?(ve=i.nextPos,i.result):(t=ve,(r=peg$parsedollar_ident())!==a&&peg$parse_()!==a?(61===e.charCodeAt(ve)?(n=u,ve++):(n=a,0===Ce&&peg$fail(f)),n!==a&&peg$parse_()!==a&&(s=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a&&peg$parsesem()!==a?(Ae=t,t=r={_type:"def$",name:r,expr:s,location:location()}):(ve=t,t=a)):(ve=t,t=a),je[p]={nextPos:ve,result:t},t)}function peg$parsetype(){var e,t=43*ve+23,r=je[t];return r?(ve=r.nextPos,r.result):((e=function peg$parsestype(){var e,t,r=43*ve+24,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parseident())!==a&&(Ae=e,t={_type:"type",ftype:!1,name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}())===a&&(e=peg$parseftype()),je[t]={nextPos:ve,result:e},e)}function peg$parseftype(){var t,r,n,s,p,i,l,o,u,f,c=43*ve+25,h=je[c];if(h)return ve=h.nextPos,h.result;if(t=ve,91===e.charCodeAt(ve)?(r=k,ve++):(r=a,0===Ce&&peg$fail(R)),r!==a)if(peg$parse_()!==a){if(n=ve,(s=peg$parsetype())!==a){for(p=[],i=ve,(l=peg$parse_())!==a?(44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parsetype())!==a?(Ae=i,i=l=peg$c113(0,f)):(ve=i,i=a)):(ve=i,i=a);i!==a;)p.push(i),i=ve,(l=peg$parse_())!==a?(44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parsetype())!==a?(Ae=i,i=l=peg$c113(0,f)):(ve=i,i=a)):(ve=i,i=a);p!==a?(Ae=n,n=s=peg$c66(s,p)):(ve=n,n=a)}else ve=n,n=a;n!==a&&(s=peg$parse_())!==a?("->"===e.substr(ve,2)?(p="->",ve+=2):(p=a,0===Ce&&peg$fail(J)),p!==a&&(i=peg$parse_())!==a&&(l=peg$parsetype())!==a&&(o=peg$parse_())!==a?(93===e.charCodeAt(ve)?(u=H,ve++):(u=a,0===Ce&&peg$fail(D)),u!==a?(Ae=t,t=r={_type:"type",ftype:!0,from:n,to:l,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[c]={nextPos:ve,result:t},t}function peg$parsevar(){var t,r=43*ve+26,n=je[r];return n?(ve=n.nextPos,n.result):((t=function peg$parseat_var(){var t,r,n=43*ve+27,s=je[n];if(s)return ve=s.nextPos,s.result;t=ve,(r=function peg$parseat_ident(){var t,r,n,s,p,i=43*ve+33,l=je[i];if(l)return ve=l.nextPos,l.result;t=ve,r=ve,64===e.charCodeAt(ve)?(n="@",ve++):(n=a,0===Ce&&peg$fail(d));if(n!==a){if(s=[],re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae)),p!==a)for(;p!==a;)s.push(p),re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;t=r!==a?e.substring(t,ve):r;return je[i]={nextPos:ve,result:t},t}())!==a&&(Ae=t,r={_type:"var",type:"@",name:r,location:location()});return t=r,je[n]={nextPos:ve,result:t},t}())===a&&(t=function peg$parsedollar_var(){var e,t,r=43*ve+28,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parsedollar_ident())!==a&&(Ae=e,t={_type:"var",type:"$",name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}())===a&&(t=function peg$parseplain_var(){var e,t,r=43*ve+29,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parseident())!==a&&(Ae=e,t={_type:"var",type:"normal",name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}()),je[r]={nextPos:ve,result:t},t)}function peg$parseannotation(){var t,r=43*ve+31,n=je[r];return n?(ve=n.nextPos,n.result):(e.substr(ve,12)===K?(t=K,ve+=12):(t=a,0===Ce&&peg$fail(Y)),t===a&&(e.substr(ve,11)===ee?(t=ee,ve+=11):(t=a,0===Ce&&peg$fail(te))),je[r]={nextPos:ve,result:t},t)}function peg$parseident(){var t,r,n,s,u,f,g,d=43*ve+32,$=je[d];if($)return ve=$.nextPos,$.result;if(t=ve,r=ve,n=ve,Ce++,s=ve,(u=function peg$parsekeyword(){var t,r=43*ve+30,n=je[r];return n?(ve=n.nextPos,n.result):(e.substr(ve,2)===U?(t=U,ve+=2):(t=a,0===Ce&&peg$fail(z)),t===a&&(e.substr(ve,5)===j?(t=j,ve+=5):(t=a,0===Ce&&peg$fail(T)),t===a&&(e.substr(ve,6)===p?(t=p,ve+=6):(t=a,0===Ce&&peg$fail(i)),t===a&&(e.substr(ve,6)===M?(t=M,ve+=6):(t=a,0===Ce&&peg$fail(I)),t===a&&(e.substr(ve,6)===c?(t=c,ve+=6):(t=a,0===Ce&&peg$fail(h)),t===a&&(e.substr(ve,7)===O?(t=O,ve+=7):(t=a,0===Ce&&peg$fail(S)),t===a&&(e.substr(ve,4)===l?(t=l,ve+=4):(t=a,0===Ce&&peg$fail(o)),t===a&&(e.substr(ve,5)===q?(t=q,ve+=5):(t=a,0===Ce&&peg$fail(F)),t===a&&(e.substr(ve,4)===B?(t=B,ve+=4):(t=a,0===Ce&&peg$fail(G)))))))))),je[r]={nextPos:ve,result:t},t)}())!==a?(f=ve,Ce++,re.test(e.charAt(ve))?(g=e.charAt(ve),ve++):(g=a,0===Ce&&peg$fail(ae)),Ce--,g===a?f=void 0:(ve=f,f=a),f!==a?s=u=[u,f]:(ve=s,s=a)):(ve=s,s=a),Ce--,s===a?n=void 0:(ve=n,n=a),n!==a){if(s=[],re.test(e.charAt(ve))?(u=e.charAt(ve),ve++):(u=a,0===Ce&&peg$fail(ae)),u!==a)for(;u!==a;)s.push(u),re.test(e.charAt(ve))?(u=e.charAt(ve),ve++):(u=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;return t=r!==a?e.substring(t,ve):r,je[d]={nextPos:ve,result:t},t}function peg$parsedollar_ident(){var t,r,n,s,p,i=43*ve+34,l=je[i];if(l)return ve=l.nextPos,l.result;if(t=ve,r=ve,36===e.charCodeAt(ve)?(n=ne,ve++):(n=a,0===Ce&&peg$fail(se)),n!==a){if(s=[],re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae)),p!==a)for(;p!==a;)s.push(p),re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;return t=r!==a?e.substring(t,ve):r,je[i]={nextPos:ve,result:t},t}function peg$parsedocumentation(){var t,r,n,s,p,i,l,o=43*ve+35,u=je[o];if(u)return ve=u.nextPos,u.result;if(t=ve,34===e.charCodeAt(ve)?(r=pe,ve++):(r=a,0===Ce&&peg$fail(ie)),r!==a){for(n=ve,s=[],p=ve,i=ve,Ce++,34===e.charCodeAt(ve)?(l=pe,ve++):(l=a,0===Ce&&peg$fail(ie)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);p!==a;)s.push(p),p=ve,i=ve,Ce++,34===e.charCodeAt(ve)?(l=pe,ve++):(l=a,0===Ce&&peg$fail(ie)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);(n=s!==a?e.substring(n,ve):s)!==a?(34===e.charCodeAt(ve)?(s=pe,ve++):(s=a,0===Ce&&peg$fail(ie)),s!==a?(Ae=t,t=r=peg$c132(n)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[o]={nextPos:ve,result:t},t}function peg$parsetex(){var t,r,n,s,p,i,l,o=43*ve+37,u=je[o];if(u)return ve=u.nextPos,u.result;if(t=ve,36===e.charCodeAt(ve)?(r=ne,ve++):(r=a,0===Ce&&peg$fail(se)),r!==a){for(n=ve,s=[],p=ve,i=ve,Ce++,36===e.charCodeAt(ve)?(l=ne,ve++):(l=a,0===Ce&&peg$fail(se)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);p!==a;)s.push(p),p=ve,i=ve,Ce++,36===e.charCodeAt(ve)?(l=ne,ve++):(l=a,0===Ce&&peg$fail(se)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);(n=s!==a?e.substring(n,ve):s)!==a?(36===e.charCodeAt(ve)?(s=ne,ve++):(s=a,0===Ce&&peg$fail(se)),s!==a?(Ae=t,t=r=peg$c132(n)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[o]={nextPos:ve,result:t},t}function peg$parsecomment(){var t,r,n,s,p,i,l=43*ve+38,o=je[l];if(o)return ve=o.nextPos,o.result;if(t=ve,"//"===e.substr(ve,2)?(r="//",ve+=2):(r=a,0===Ce&&peg$fail(he)),r!==a){for(n=[],s=ve,p=ve,Ce++,i=peg$parsenewline(),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);s!==a;)n.push(s),s=ve,p=ve,Ce++,i=peg$parsenewline(),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);n!==a?t=r=[r,n]:(ve=t,t=a)}else ve=t,t=a;if(t===a)if(t=ve,"/*"===e.substr(ve,2)?(r="/*",ve+=2):(r=a,0===Ce&&peg$fail(ge)),r!==a){for(n=[],s=ve,p=ve,Ce++,e.substr(ve,2)===de?(i=de,ve+=2):(i=a,0===Ce&&peg$fail($e)),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);s!==a;)n.push(s),s=ve,p=ve,Ce++,e.substr(ve,2)===de?(i=de,ve+=2):(i=a,0===Ce&&peg$fail($e)),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);n!==a?(e.substr(ve,2)===de?(s=de,ve+=2):(s=a,0===Ce&&peg$fail($e)),s!==a?t=r=[r,n,s]:(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[l]={nextPos:ve,result:t},t}function peg$parsenewline(){var t,r=43*ve+39,n=je[r];return n?(ve=n.nextPos,n.result):("\r\n"===e.substr(ve,2)?(t="\r\n",ve+=2):(t=a,0===Ce&&peg$fail(_e)),t===a&&(13===e.charCodeAt(ve)?(t="\r",ve++):(t=a,0===Ce&&peg$fail(xe)),t===a&&(10===e.charCodeAt(ve)?(t="\n",ve++):(t=a,0===Ce&&peg$fail(me)))),je[r]={nextPos:ve,result:t},t)}function peg$parse_(){var t,r,n=43*ve+40,s=je[n];if(s)return ve=s.nextPos,s.result;for(t=[],ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());r!==a;)t.push(r),ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());return je[n]={nextPos:ve,result:t},t}function peg$parse__(){var t,r,n=43*ve+41,s=je[n];if(s)return ve=s.nextPos,s.result;if(t=[],ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment()),r!==a)for(;r!==a;)t.push(r),ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());else t=a;return je[n]={nextPos:ve,result:t},t}function peg$parsesem(){var t,r=43*ve+42,n=je[r];return n?(ve=n.nextPos,n.result):(59===e.charCodeAt(ve)?(t=";",ve++):(t=a,0===Ce&&peg$fail(X)),je[r]={nextPos:ve,result:t},t)}if((r=s())!==a&&ve===e.length)return r;throw r!==a&&ve<e.length&&peg$fail({type:"end"}),peg$buildStructuredError(Ee,we<e.length?e.charAt(we):null,we<e.length?peg$computeLocation(we,we+1):peg$computeLocation(we,we))}}},function(e,t,r){"use strict";function peg$SyntaxError(e,t,r,a){this.message=e,this.expected=t,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,peg$SyntaxError)}!function peg$subclass(e,t){function ctor(){this.constructor=e}ctor.prototype=t.prototype,e.prototype=new ctor}(peg$SyntaxError,Error),peg$SyntaxError.buildMessage=function(e,t){var r={literal:function(e){return'"'+literalEscape(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?classEscape(e.parts[t][0])+"-"+classEscape(e.parts[t][1]):classEscape(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function hex(e){return e.charCodeAt(0).toString(16).toUpperCase()}function literalEscape(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}function classEscape(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+hex(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+hex(e)}))}return"Expected "+function describeExpected(e){var t,a,n,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(n=e[t],r[n.type](n));if(s.sort(),s.length>0){for(t=1,a=1;t<s.length;t++)s[t-1]!==s[t]&&(s[a]=s[t],a++);s.length=a}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function describeFound(e){return e?'"'+literalEscape(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:peg$SyntaxError,parse:function peg$parse(e,t){t=void 0!==t?t:{};var r,a={},n={evaluable:peg$parseevaluable},s=peg$parseevaluable,p="import",i=peg$literalExpectation("import",!1),l="type",o=peg$literalExpectation("type",!1),u="=",f=peg$literalExpectation("=",!1),c="sealed",h=peg$literalExpectation("sealed",!1),g=peg$literalExpectation(":",!1),d=peg$literalExpectation("@",!1),$=/^[a-z0-9_]/,_=peg$classExpectation([["a","z"],["0","9"],"_"],!1,!1),x="(",m=peg$literalExpectation("(",!1),y=",",b=peg$literalExpectation(",",!1),peg$c31=function(e,t,r,a,n,s,p,i){return i},v=")",A=peg$literalExpectation(")",!1),P="{",w=peg$literalExpectation("{",!1),E="}",C=peg$literalExpectation("}",!1),peg$c43=function(e,t){return t},j="axiom",T=peg$literalExpectation("axiom",!1),O="theorem",S=peg$literalExpectation("theorem",!1),M="schema",I=peg$literalExpectation("schema",!1),peg$c50=function(e,t,r,a,n,s){return s},q="using",F=peg$literalExpectation("using",!1),peg$c55=function(e,t,r,a,n,s,p){return p},peg$c58=function(e,t,r,a,n,s,p){return p},k="[",R=peg$literalExpectation("[",!1),X=peg$literalExpectation(";",!1),peg$c65=function(e,t){return t},peg$c66=function(e,t){return[e].concat(t)},H="]",D=peg$literalExpectation("]",!1),V=peg$literalExpectation(">",!1),peg$c72=function(e,t){return t},N="?",L=peg$literalExpectation("?",!1),peg$c77=function(e,t,r,a){return a},peg$c78=function(e,t,r,a){return[r].concat(a)},peg$c79=function(e,t,r){return r||[]},U="as",z=peg$literalExpectation("as",!1),peg$c82=function(e,t,r,a){return a},peg$c83=function(e,t,r,a){return{subject:t,args:r,as_:a||null}},peg$c85=function(e,t,r){return r},peg$c86=function(e,t,r){return[t].concat(r)},peg$c87=function(e,t){return t||[]},peg$c90=function(e,t){return t},peg$c91=function(e){return e||[]},Q="=>",W=peg$literalExpectation("=>",!1),peg$c97=function(e,t){return t},Z=peg$literalExpectation("|-",!1),peg$c104=function(e,t){return t},B="with",G=peg$literalExpectation("with",!1),peg$c109=function(e,t,r,a,n,s){return s},peg$c113=function(e,t){return t},J=peg$literalExpectation("->",!1),K="@discouraged",Y=peg$literalExpectation("@discouraged",!1),ee="@deprecated",te=peg$literalExpectation("@deprecated",!1),re=/^[a-zA-Z0-9_]/,ae=peg$classExpectation([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ne="$",se=peg$literalExpectation("$",!1),pe='"',ie=peg$literalExpectation('"',!1),le={type:"any"},peg$c132=function(e){return e.replace(/\r\n|\r/g,"\n")},oe="precedence=",ue=peg$literalExpectation("precedence=",!1),fe=/^[0-9]/,ce=peg$classExpectation([["0","9"]],!1,!1),he=peg$literalExpectation("//",!1),ge=peg$literalExpectation("/*",!1),de="*/",$e=peg$literalExpectation("*/",!1),_e=peg$literalExpectation("\r\n",!1),xe=peg$literalExpectation("\r",!1),me=peg$literalExpectation("\n",!1),ye=/^[ \t\n\r]/,be=peg$classExpectation([" ","\t","\n","\r"],!1,!1),ve=0,Ae=0,Pe=[{line:1,column:1}],we=0,Ee=[],Ce=0,je={};if("startRule"in t){if(!(t.startRule in n))throw new Error("Can't start parsing from rule \""+t.startRule+'".');s=n[t.startRule]}function location(){return peg$computeLocation(Ae,ve)}function peg$literalExpectation(e,t){return{type:"literal",text:e,ignoreCase:t}}function peg$classExpectation(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function peg$computePosDetails(t){var r,a=Pe[t];if(a)return a;for(r=t-1;!Pe[r];)r--;for(a={line:(a=Pe[r]).line,column:a.column};r<t;)10===e.charCodeAt(r)?(a.line++,a.column=1):a.column++,r++;return Pe[t]=a,a}function peg$computeLocation(e,t){var r=peg$computePosDetails(e),a=peg$computePosDetails(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:a.line,column:a.column}}}function peg$fail(e){ve<we||(ve>we&&(we=ve,Ee=[]),Ee.push(e))}function peg$buildStructuredError(e,t,r){return new peg$SyntaxError(peg$SyntaxError.buildMessage(e,t),e,t,r)}function peg$parseevaluable(){var e,t,r=43*ve+2,n=je[r];return n?(ve=n.nextPos,n.result):(e=ve,peg$parse_()!==a&&(t=function peg$parseevaluable_internal(){var e,t=43*ve+3,r=je[t];if(r)return ve=r.nextPos,r.result;(e=peg$parsetypedef())===a&&(e=peg$parsedefv())===a&&(e=peg$parsedefun())===a&&(e=peg$parsedefschema())===a&&(e=peg$parseexpr_internal_3());return je[t]={nextPos:ve,result:e},e}())!==a&&peg$parse_()!==a?(Ae=e,e=t):(ve=e,e=a),je[r]={nextPos:ve,result:e},e)}function peg$parsetypedef(){var t,r,n,s,p,i,c,h,g,d,$,_=43*ve+5,x=je[_];return x?(ve=x.nextPos,x.result):(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a?(e.substr(ve,4)===l?(n=l,ve+=4):(n=a,0===Ce&&peg$fail(o)),n!==a&&(s=peg$parse__())!==a&&(p=peg$parseident())!==a&&peg$parse_()!==a?(i=ve,61===e.charCodeAt(ve)?(c=u,ve++):(c=a,0===Ce&&peg$fail(f)),c!==a&&peg$parse_()!==a&&(h=peg$parseftype())!==a&&peg$parse_()!==a?(Ae=i,i=c=h):(ve=i,i=a),i===a&&(i=null),i!==a&&(c=peg$parsesem())!==a?(Ae=t,d=p,$=i,t=r={_type:"typedef",doc:(g=r)?g[0]:null,expr:$,name:d,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[_]={nextPos:ve,result:t},t)}function peg$parsedefv(){var t,r,n,s,p,i,l,o,g,d,$=43*ve+6,_=je[$];return _?(ve=_.nextPos,_.result):(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a?(n=ve,(s=peg$parsetex())!==a&&(p=peg$parse__())!==a?n=s=[s,p]:(ve=n,n=a),n===a&&(n=null),n!==a?(s=ve,e.substr(ve,6)===c?(p=c,ve+=6):(p=a,0===Ce&&peg$fail(h)),p!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a&&(p=peg$parsetype())!==a&&(i=peg$parse__())!==a&&(l=peg$parseident())!==a&&peg$parse_()!==a?(o=ve,61===e.charCodeAt(ve)?(g=u,ve++):(g=a,0===Ce&&peg$fail(f)),g!==a&&peg$parse_()!==a&&(d=peg$parseobjectexpr())!==a&&peg$parse_()!==a&&peg$parsesem()!==a?(Ae=o,o=g=d):(ve=o,o=a),o===a&&(o=ve,(g=peg$parsesem())!==a&&(Ae=o,g=null),o=g),o!==a?(Ae=t,t=r=function(e,t,r,a,n,s){return{_type:"defv",isParam:!1,doc:e?e[0]:null,tex:t?t[0]:null,sealed:!!r,type:a,name:n,expr:s,location:location()}}(r,n,s,p,l,o)):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[$]={nextPos:ve,result:t},t)}function peg$parsedefparam(){var e,t,r,n,s,p,i,l,o=43*ve+7,u=je[o];return u?(ve=u.nextPos,u.result):(e=ve,t=ve,(r=peg$parsetex())!==a&&(n=peg$parse__())!==a?t=r=[r,n]:(ve=t,t=a),t===a&&(t=null),t!==a&&(r=peg$parsetype())!==a&&(n=peg$parse__())!==a&&(s=peg$parseident())!==a?(Ae=e,i=r,l=s,e=t={_type:"defv",isParam:!0,doc:null,tex:(p=t)?p[0]:null,type:i,name:l,location:location()}):(ve=e,e=a),je[o]={nextPos:ve,result:e},e)}function peg$parsedefschemaparam(){var t,r,n,s,p,i,l,o,u,f,c,h,x,m,y,b=43*ve+8,v=je[b];if(v)return ve=v.nextPos,v.result;if(t=ve,r=ve,(n=peg$parsetex())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a)if((n=peg$parsetype())!==a)if((s=peg$parse__())!==a)if((p=peg$parseident())!==a){if(i=ve,peg$parse_()!==a)if(58===e.charCodeAt(ve)?(l=":",ve++):(l=a,0===Ce&&peg$fail(g)),l!==a)if(peg$parse_()!==a)if(64===e.charCodeAt(ve)?(o="@",ve++):(o=a,0===Ce&&peg$fail(d)),o!==a){if(u=ve,f=[],$.test(e.charAt(ve))?(c=e.charAt(ve),ve++):(c=a,0===Ce&&peg$fail(_)),c!==a)for(;c!==a;)f.push(c),$.test(e.charAt(ve))?(c=e.charAt(ve),ve++):(c=a,0===Ce&&peg$fail(_));else f=a;(u=f!==a?e.substring(u,ve):f)!==a?(Ae=i,i=u):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(Ae=t,x=n,m=p,y=i,t=r={_type:"defv",isParam:!0,doc:null,tex:(h=r)?h[0]:null,type:x,name:m,selector:y,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[b]={nextPos:ve,result:t},t}function peg$parsedefun(){var t,r,n,s,p,i,l,o,u,f,g,d,$,_,j,T,O,S=43*ve+9,M=je[S];if(M)return ve=M.nextPos,M.result;if(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a)if(n=ve,(s=function peg$parsetex_attributes(){var t,r,n,s,p,i,l=43*ve+36,o=je[l];if(o)return ve=o.nextPos,o.result;t=ve,91===e.charCodeAt(ve)?(r=k,ve++):(r=a,0===Ce&&peg$fail(R));if(r!==a)if(peg$parse_()!==a)if(e.substr(ve,11)===oe?(n=oe,ve+=11):(n=a,0===Ce&&peg$fail(ue)),n!==a)if(peg$parse_()!==a){if(s=ve,p=[],fe.test(e.charAt(ve))?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(ce)),i!==a)for(;i!==a;)p.push(i),fe.test(e.charAt(ve))?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(ce));else p=a;(s=p!==a?e.substring(s,ve):p)!==a&&(p=peg$parse_())!==a?(93===e.charCodeAt(ve)?(i=H,ve++):(i=a,0===Ce&&peg$fail(D)),i!==a?(Ae=t,t=r={precedence:1*s}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[l]={nextPos:ve,result:t},t}())!==a&&(p=peg$parse__())!==a?n=s=[s,p]:(ve=n,n=a),n===a&&(n=null),n!==a)if(s=ve,(p=peg$parsetex())!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a)if(p=ve,e.substr(ve,6)===c?(i=c,ve+=6):(i=a,0===Ce&&peg$fail(h)),i!==a&&(l=peg$parse__())!==a?p=i=[i,l]:(ve=p,p=a),p===a&&(p=null),p!==a)if((i=peg$parsetype())!==a)if((l=peg$parse__())!==a)if((o=peg$parseident())!==a)if(peg$parse_()!==a){if(u=ve,40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((g=peg$parse_())!==a){if(d=ve,($=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(_=[],j=ve,44===e.charCodeAt(ve)?(T=y,ve++):(T=a,0===Ce&&peg$fail(b)),T!==a&&peg$parse_()!==a&&(O=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=j,j=T=peg$c31(0,0,0,0,0,0,0,O)):(ve=j,j=a);j!==a;)_.push(j),j=ve,44===e.charCodeAt(ve)?(T=y,ve++):(T=a,0===Ce&&peg$fail(b)),T!==a&&peg$parse_()!==a&&(O=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=j,j=T=peg$c31(0,0,0,0,0,0,0,O)):(ve=j,j=a);_!==a?(Ae=d,d=$=[$].concat(_)):(ve=d,d=a)}else ve=d,d=a;else ve=d,d=a;d===a&&(d=null),d!==a?(41===e.charCodeAt(ve)?($=v,ve++):($=a,0===Ce&&peg$fail(A)),$!==a&&peg$parse_()!==a?(Ae=u,u=f=d||[]):(ve=u,u=a)):(ve=u,u=a)}else ve=u,u=a;else ve=u,u=a;u!==a?(f=ve,123===e.charCodeAt(ve)?(g=P,ve++):(g=a,0===Ce&&peg$fail(w)),g!==a&&(d=peg$parse_())!==a&&($=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(_=E,ve++):(_=a,0===Ce&&peg$fail(C)),_!==a?(Ae=f,f=g=$):(ve=f,f=a)):(ve=f,f=a),f===a&&(f=ve,(g=peg$parsesem())!==a&&(Ae=f,g=null),f=g),f!==a?(Ae=t,t=r=function(e,t,r,a,n,s,p,i){return{_type:"defun",doc:e?e[0]:null,tex_attributes:t?t[0]:{precedence:!1},tex:r?r[0]:null,sealed:!!a,rettype:n,name:s,params:p,expr:i,location:location()}}(r,n,s,p,i,o,u,f)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[S]={nextPos:ve,result:t},t}function peg$parsedefschema(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d,$,_,k,R,X,H,D,V,N,L,U,z,Q=43*ve+10,W=je[Q];if(W)return ve=W.nextPos,W.result;if(t=ve,r=ve,(n=peg$parsedocumentation())!==a&&(s=peg$parse__())!==a?r=n=[n,s]:(ve=r,r=a),r===a&&(r=null),r!==a){for(n=[],s=ve,(p=peg$parseannotation())!==a&&(i=peg$parse__())!==a?(Ae=s,s=p=peg$c43(0,p)):(ve=s,s=a);s!==a;)n.push(s),s=ve,(p=peg$parseannotation())!==a&&(i=peg$parse__())!==a?(Ae=s,s=p=peg$c43(0,p)):(ve=s,s=a);if(n!==a)if(e.substr(ve,5)===j?(s=j,ve+=5):(s=a,0===Ce&&peg$fail(T)),s===a&&(e.substr(ve,7)===O?(s=O,ve+=7):(s=a,0===Ce&&peg$fail(S)),s===a&&(e.substr(ve,6)===M?(s=M,ve+=6):(s=a,0===Ce&&peg$fail(I)))),s!==a)if((p=peg$parse__())!==a)if((i=peg$parseident())!==a)if(peg$parse_()!==a){if(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a)if((u=peg$parse_())!==a){if(f=ve,(c=peg$parsedefschemaparam())!==a)if((h=peg$parse_())!==a){for(g=[],d=ve,44===e.charCodeAt(ve)?($=y,ve++):($=a,0===Ce&&peg$fail(b)),$!==a&&(_=peg$parse_())!==a&&(k=peg$parsedefschemaparam())!==a&&(R=peg$parse_())!==a?(Ae=d,d=$=peg$c50(0,0,0,0,0,k)):(ve=d,d=a);d!==a;)g.push(d),d=ve,44===e.charCodeAt(ve)?($=y,ve++):($=a,0===Ce&&peg$fail(b)),$!==a&&(_=peg$parse_())!==a&&(k=peg$parsedefschemaparam())!==a&&(R=peg$parse_())!==a?(Ae=d,d=$=peg$c50(0,0,0,0,0,k)):(ve=d,d=a);g!==a?(Ae=f,f=c=[c].concat(g)):(ve=f,f=a)}else ve=f,f=a;else ve=f,f=a;f===a&&(f=null),f!==a?(41===e.charCodeAt(ve)?(c=v,ve++):(c=a,0===Ce&&peg$fail(A)),c!==a&&(h=peg$parse_())!==a?(Ae=l,l=o=f||[]):(ve=l,l=a)):(ve=l,l=a)}else ve=l,l=a;else ve=l,l=a;if(l!==a){if(o=ve,e.substr(ve,5)===q?(u=q,ve+=5):(u=a,0===Ce&&peg$fail(F)),u!==a)if((f=peg$parse__())!==a){if(c=ve,(h=peg$parseident())!==a)if((g=peg$parse_())!==a){for(d=[],$=ve,44===e.charCodeAt(ve)?(_=y,ve++):(_=a,0===Ce&&peg$fail(b)),_!==a&&(k=peg$parse_())!==a&&(R=peg$parseident())!==a&&peg$parse_()!==a?(Ae=$,$=_=peg$c55(0,0,0,0,0,0,R)):(ve=$,$=a);$!==a;)d.push($),$=ve,44===e.charCodeAt(ve)?(_=y,ve++):(_=a,0===Ce&&peg$fail(b)),_!==a&&(k=peg$parse_())!==a&&(R=peg$parseident())!==a&&peg$parse_()!==a?(Ae=$,$=_=peg$c55(0,0,0,0,0,0,R)):(ve=$,$=a);d!==a?(Ae=c,c=h=function(e,t,r,a,n,s,p){return[s].concat(p)}(0,0,0,0,0,h,d)):(ve=c,c=a)}else ve=c,c=a;else ve=c,c=a;c!==a?(Ae=o,o=u=c):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;if(o===a&&(o=null),o!==a)if(123===e.charCodeAt(ve)?(u=P,ve++):(u=a,0===Ce&&peg$fail(w)),u!==a)if((f=peg$parse_())!==a){for(c=[],h=ve,(g=peg$parsedefdollar())!==a&&(d=peg$parse_())!==a?(Ae=h,h=g=peg$c58(0,0,0,0,0,0,g)):(ve=h,h=a);h!==a;)c.push(h),h=ve,(g=peg$parsedefdollar())!==a&&(d=peg$parse_())!==a?(Ae=h,h=g=peg$c58(0,0,0,0,0,0,g)):(ve=h,h=a);c!==a&&(h=peg$parse_())!==a&&(g=peg$parseexpr_internal_3())!==a&&(d=peg$parse_())!==a?(125===e.charCodeAt(ve)?($=E,ve++):($=a,0===Ce&&peg$fail(C)),$!==a?(Ae=t,H=n,D=s,V=i,N=l,L=o,U=c,z=g,t=r={_type:"defschema",doc:(X=r)?X[0]:null,annotations:H,schemaType:D,name:V,params:N,using:L||[],def$s:U,expr:z,location:location()}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a}else ve=t,t=a}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a}else ve=t,t=a;return je[Q]={nextPos:ve,result:t},t}function peg$parsereduction(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d,$,_,P,w,E,C=43*ve+11,j=je[C];if(j)return ve=j.nextPos,j.result;if(t=ve,r=ve,(n=peg$parseexpr_internal_2())!==a&&(Ae=r,n=[n]),(r=n)===a)if(r=ve,91===e.charCodeAt(ve)?(n=k,ve++):(n=a,0===Ce&&peg$fail(R)),n!==a)if((s=peg$parse_())!==a){if(p=ve,(i=peg$parseexpr_internal_3())!==a)if(peg$parse_()!==a){for(l=[],o=ve,59===e.charCodeAt(ve)?(u=";",ve++):(u=a,0===Ce&&peg$fail(X)),u!==a&&(f=peg$parse_())!==a&&(c=peg$parseexpr_internal_3())!==a&&(h=peg$parse_())!==a?(Ae=o,o=u=peg$c65(0,c)):(ve=o,o=a);o!==a;)l.push(o),o=ve,59===e.charCodeAt(ve)?(u=";",ve++):(u=a,0===Ce&&peg$fail(X)),u!==a&&(f=peg$parse_())!==a&&(c=peg$parseexpr_internal_3())!==a&&(h=peg$parse_())!==a?(Ae=o,o=u=peg$c65(0,c)):(ve=o,o=a);l!==a?(Ae=p,p=i=peg$c66(i,l)):(ve=p,p=a)}else ve=p,p=a;else ve=p,p=a;p===a&&(p=null),p!==a?(93===e.charCodeAt(ve)?(i=H,ve++):(i=a,0===Ce&&peg$fail(D)),i!==a?(Ae=r,r=n=p||[]):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;if(r!==a){if(n=[],s=ve,(p=peg$parse_())!==a)if(62===e.charCodeAt(ve)?(i=">",ve++):(i=a,0===Ce&&peg$fail(V)),i!==a)if(peg$parse_()!==a)if((l=peg$parseschemacall())===a&&(l=peg$parsevar())===a&&(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&(c=peg$parse_())!==a?(41===e.charCodeAt(ve)?(h=v,ve++):(h=a,0===Ce&&peg$fail(A)),h!==a?(Ae=l,l=o=peg$c72(0,f)):(ve=l,l=a)):(ve=l,l=a)),l!==a){if(o=ve,(u=peg$parse_())!==a)if(40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((c=peg$parse_())!==a){if(h=ve,g=ve,63===e.charCodeAt(ve)?(d=N,ve++):(d=a,0===Ce&&peg$fail(L)),d!==a&&(Ae=g,d=null),(g=d)===a&&(g=peg$parseobjectexpr()),g!==a)if((d=peg$parse_())!==a){for($=[],_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);_!==a;)$.push(_),_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);$!==a?(Ae=h,h=g=peg$c78(0,0,g,$)):(ve=h,h=a)}else ve=h,h=a;else ve=h,h=a;h===a&&(h=null),h!==a?(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a?(Ae=o,o=u=peg$c79(0,0,h)):(ve=o,o=a)):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;else ve=o,o=a;o===a&&(o=null),o!==a?(u=ve,(f=peg$parse__())!==a?(e.substr(ve,2)===U?(c=U,ve+=2):(c=a,0===Ce&&peg$fail(z)),c!==a&&(h=peg$parse__())!==a&&(g=peg$parseexpr_internal_2())!==a?(Ae=u,u=f=peg$c82(0,0,0,g)):(ve=u,u=a)):(ve=u,u=a),u===a&&(u=null),u!==a?(Ae=s,s=p=peg$c83(0,l,o,u)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;if(s!==a)for(;s!==a;)if(n.push(s),s=ve,(p=peg$parse_())!==a)if(62===e.charCodeAt(ve)?(i=">",ve++):(i=a,0===Ce&&peg$fail(V)),i!==a)if(peg$parse_()!==a)if((l=peg$parseschemacall())===a&&(l=peg$parsevar())===a&&(l=ve,40===e.charCodeAt(ve)?(o=x,ve++):(o=a,0===Ce&&peg$fail(m)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&(c=peg$parse_())!==a?(41===e.charCodeAt(ve)?(h=v,ve++):(h=a,0===Ce&&peg$fail(A)),h!==a?(Ae=l,l=o=peg$c72(0,f)):(ve=l,l=a)):(ve=l,l=a)),l!==a){if(o=ve,(u=peg$parse_())!==a)if(40===e.charCodeAt(ve)?(f=x,ve++):(f=a,0===Ce&&peg$fail(m)),f!==a)if((c=peg$parse_())!==a){if(h=ve,g=ve,63===e.charCodeAt(ve)?(d=N,ve++):(d=a,0===Ce&&peg$fail(L)),d!==a&&(Ae=g,d=null),(g=d)===a&&(g=peg$parseobjectexpr()),g!==a)if((d=peg$parse_())!==a){for($=[],_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);_!==a;)$.push(_),_=ve,44===e.charCodeAt(ve)?(P=y,ve++):(P=a,0===Ce&&peg$fail(b)),P!==a&&peg$parse_()!==a?(w=ve,63===e.charCodeAt(ve)?(E=N,ve++):(E=a,0===Ce&&peg$fail(L)),E!==a&&(Ae=w,E=null),(w=E)===a&&(w=peg$parseobjectexpr()),w!==a&&(E=peg$parse_())!==a?(Ae=_,_=P=peg$c77(0,0,0,w)):(ve=_,_=a)):(ve=_,_=a);$!==a?(Ae=h,h=g=peg$c78(0,0,g,$)):(ve=h,h=a)}else ve=h,h=a;else ve=h,h=a;h===a&&(h=null),h!==a?(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a?(Ae=o,o=u=peg$c79(0,0,h)):(ve=o,o=a)):(ve=o,o=a)}else ve=o,o=a;else ve=o,o=a;else ve=o,o=a;o===a&&(o=null),o!==a?(u=ve,(f=peg$parse__())!==a?(e.substr(ve,2)===U?(c=U,ve+=2):(c=a,0===Ce&&peg$fail(z)),c!==a&&(h=peg$parse__())!==a&&(g=peg$parseexpr_internal_2())!==a?(Ae=u,u=f=peg$c82(0,0,0,g)):(ve=u,u=a)):(ve=u,u=a),u===a&&(u=null),u!==a?(Ae=s,s=p=peg$c83(0,l,o,u)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else ve=s,s=a;else n=a;n!==a?(Ae=t,t=r=function(e,t){for(var r={_type:"reduction",subject:t[0].subject,args:t[0].args,antecedents:e,as:t[0].as_,location:location()},a=1;a<t.length;a++)r={_type:"reduction",subject:t[a].subject,args:t[a].args,antecedents:[r],as:t[a].as_,location:location()};return r}(r,n)):(ve=t,t=a)}else ve=t,t=a;return je[C]={nextPos:ve,result:t},t}function peg$parseschemacall(){var t,r,n,s,p,i,l,o,u,f,c,h=43*ve+12,g=je[h];if(g)return ve=g.nextPos,g.result;if(t=ve,(r=peg$parsevar())===a&&(r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a&&(s=peg$parse_())!==a&&(p=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(i=v,ve++):(i=a,0===Ce&&peg$fail(A)),i!==a?(Ae=r,r=n=p):(ve=r,r=a)):(ve=r,r=a)),r!==a)if((n=peg$parse_())!==a){if(s=ve,40===e.charCodeAt(ve)?(p=x,ve++):(p=a,0===Ce&&peg$fail(m)),p!==a)if(peg$parse_()!==a){if(i=ve,(l=peg$parseobjectexpr())!==a)if(peg$parse_()!==a){for(o=[],u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);u!==a;)o.push(u),u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);o!==a?(Ae=i,i=l=peg$c86(0,l,o)):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(41===e.charCodeAt(ve)?(l=v,ve++):(l=a,0===Ce&&peg$fail(A)),l!==a?(Ae=s,s=p=peg$c87(0,i)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"schemacall",schema:r,args:s,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[h]={nextPos:ve,result:t},t}function peg$parsefuncall(){var t,r,n,s,p,i,l,o,u,f,c,h=43*ve+13,g=je[h];if(g)return ve=g.nextPos,g.result;if(t=ve,(r=peg$parsevar())===a&&(r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a&&(s=peg$parse_())!==a&&(p=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(i=v,ve++):(i=a,0===Ce&&peg$fail(A)),i!==a?(Ae=r,r=n=p):(ve=r,r=a)):(ve=r,r=a)),r!==a)if((n=peg$parse_())!==a){if(s=ve,40===e.charCodeAt(ve)?(p=x,ve++):(p=a,0===Ce&&peg$fail(m)),p!==a)if(peg$parse_()!==a){if(i=ve,(l=peg$parseobjectexpr())!==a)if(peg$parse_()!==a){for(o=[],u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);u!==a;)o.push(u),u=ve,44===e.charCodeAt(ve)?(f=y,ve++):(f=a,0===Ce&&peg$fail(b)),f!==a&&peg$parse_()!==a&&(c=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c85(0,0,c)):(ve=u,u=a);o!==a?(Ae=i,i=l=peg$c86(0,l,o)):(ve=i,i=a)}else ve=i,i=a;else ve=i,i=a;i===a&&(i=null),i!==a?(41===e.charCodeAt(ve)?(l=v,ve++):(l=a,0===Ce&&peg$fail(A)),l!==a?(Ae=s,s=p=peg$c87(0,i)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"funcall",schema:r,args:s,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[h]={nextPos:ve,result:t},t}function peg$parsefunexpr(){var t,r,n,s,p,i,l,o,u,f=43*ve+14,c=je[f];if(c)return ve=c.nextPos,c.result;if(t=ve,r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);i!==a?(Ae=s,s=p=peg$c66(p,i)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s===a&&(s=null),s!==a?(41===e.charCodeAt(ve)?(p=v,ve++):(p=a,0===Ce&&peg$fail(A)),p!==a&&peg$parse_()!==a?(Ae=r,r=n=peg$c91(s)):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;return r!==a?(e.substr(ve,2)===Q?(n=Q,ve+=2):(n=a,0===Ce&&peg$fail(W)),n!==a&&peg$parse_()!==a?((s=peg$parseobjectexpr())===a&&(s=ve,123===e.charCodeAt(ve)?(p=P,ve++):(p=a,0===Ce&&peg$fail(w)),p!==a&&peg$parse_()!==a&&(i=peg$parseobjectexpr())!==a&&(l=peg$parse_())!==a?(125===e.charCodeAt(ve)?(o=E,ve++):(o=a,0===Ce&&peg$fail(C)),o!==a?(Ae=s,s=p=i):(ve=s,s=a)):(ve=s,s=a)),s!==a?(Ae=t,t=r={_type:"funexpr",params:r,expr:s,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a),je[f]={nextPos:ve,result:t},t}function peg$parseschemaexpr(){var t,r,n,s,p,i,l,o,u,f,c=43*ve+15,h=je[c];if(h)return ve=h.nextPos,h.result;if(t=ve,r=ve,40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parsedefparam())!==a)if(peg$parse_()!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&peg$parse_()!==a&&(u=peg$parsedefparam())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c90(0,u)):(ve=l,l=a);i!==a?(Ae=s,s=p=peg$c66(p,i)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s===a&&(s=null),s!==a?(41===e.charCodeAt(ve)?(p=v,ve++):(p=a,0===Ce&&peg$fail(A)),p!==a&&peg$parse_()!==a?(Ae=r,r=n=peg$c91(s)):(ve=r,r=a)):(ve=r,r=a)}else ve=r,r=a;else ve=r,r=a;if(r!==a)if(e.substr(ve,2)===Q?(n=Q,ve+=2):(n=a,0===Ce&&peg$fail(W)),n!==a)if(peg$parse_()!==a){if(s=ve,(p=peg$parseexpr_internal_1())!==a&&(Ae=s,p={defdollars:[],expr:p}),(s=p)===a)if(s=ve,123===e.charCodeAt(ve)?(p=P,ve++):(p=a,0===Ce&&peg$fail(w)),p!==a)if(peg$parse_()!==a){for(i=[],l=ve,(o=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c97(0,o)):(ve=l,l=a);l!==a;)i.push(l),l=ve,(o=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c97(0,o)):(ve=l,l=a);i!==a&&(l=peg$parse_())!==a&&(o=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(u=E,ve++):(u=a,0===Ce&&peg$fail(C)),u!==a?(Ae=s,s=p=function(e,t,r){return{defdollars:t,expr:r}}(0,i,o)):(ve=s,s=a)):(ve=s,s=a)}else ve=s,s=a;else ve=s,s=a;s!==a?(Ae=t,t=r={_type:"schemaexpr",params:r,def$s:(f=s).defdollars,expr:f.expr,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[c]={nextPos:ve,result:t},t}function peg$parsetee(){var t,r,n,s,p,i,l,o,u,f,c,h,g,d=43*ve+16,$=je[d];if($)return ve=$.nextPos,$.result;if(t=ve,r=ve,n=ve,(s=peg$parseexpr_internal_1())!==a)if((p=peg$parse_())!==a){for(i=[],l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_1())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c65(0,f)):(ve=l,l=a);l!==a;)i.push(l),l=ve,44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_1())!==a&&peg$parse_()!==a?(Ae=l,l=o=peg$c65(0,f)):(ve=l,l=a);i!==a?(Ae=n,n=s=peg$c66(s,i)):(ve=n,n=a)}else ve=n,n=a;else ve=n,n=a;if(n===a&&(n=null),n!==a&&(Ae=r,n=n||[]),(r=n)!==a)if("|-"===e.substr(ve,2)?(n="|-",ve+=2):(n=a,0===Ce&&peg$fail(Z)),n!==a)if((s=peg$parse_())!==a){if(p=ve,(i=peg$parseexpr_internal_2())!==a&&(Ae=p,i={defdollars:[],expr:i}),(p=i)===a)if(p=ve,123===e.charCodeAt(ve)?(i=P,ve++):(i=a,0===Ce&&peg$fail(w)),i!==a)if((l=peg$parse_())!==a){for(o=[],u=ve,(f=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c104(0,f)):(ve=u,u=a);u!==a;)o.push(u),u=ve,(f=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=u,u=f=peg$c104(0,f)):(ve=u,u=a);o!==a&&(u=peg$parse_())!==a&&(f=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(c=E,ve++):(c=a,0===Ce&&peg$fail(C)),c!==a?(Ae=p,p=i=function(e,t,r){return{defdollars:t,expr:r}}(0,o,f)):(ve=p,p=a)):(ve=p,p=a)}else ve=p,p=a;else ve=p,p=a;p!==a?(Ae=t,h=r,t=r={_type:"tee",def$s:(g=p).defdollars,left:h,right:g.expr,location:location()}):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[d]={nextPos:ve,result:t},t}function peg$parsewith(){var t,r,n,s,p,i,l,o,c,h,g,d,$,_,y,b,j,T,O,S,M,I,q,F=43*ve+17,k=je[F];if(k)return ve=k.nextPos,k.result;if(t=ve,e.substr(ve,4)===B?(r=B,ve+=4):(r=a,0===Ce&&peg$fail(G)),r!==a)if(peg$parse_()!==a)if(40===e.charCodeAt(ve)?(n=x,ve++):(n=a,0===Ce&&peg$fail(m)),n!==a)if(peg$parse_()!==a)if(s=ve,(p=peg$parsedocumentation())!==a&&(i=peg$parse__())!==a?s=p=[p,i]:(ve=s,s=a),s===a&&(s=null),s!==a)if(p=ve,(i=peg$parsetex())!==a&&(l=peg$parse__())!==a?p=i=[i,l]:(ve=p,p=a),p===a&&(p=null),p!==a)if((i=peg$parsetype())!==a)if((l=peg$parse__())!==a)if((o=peg$parseident())!==a)if(peg$parse_()!==a)if(61===e.charCodeAt(ve)?(c=u,ve++):(c=a,0===Ce&&peg$fail(f)),c!==a)if(peg$parse_()!==a)if((h=peg$parseobjectexpr())!==a)if(peg$parse_()!==a)if(41===e.charCodeAt(ve)?(g=v,ve++):(g=a,0===Ce&&peg$fail(A)),g!==a)if(peg$parse_()!==a)if(123===e.charCodeAt(ve)?(d=P,ve++):(d=a,0===Ce&&peg$fail(w)),d!==a)if(peg$parse_()!==a){for($=[],_=ve,(y=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=_,_=y=peg$c109(0,0,0,0,0,y)):(ve=_,_=a);_!==a;)$.push(_),_=ve,(y=peg$parsedefdollar())!==a&&peg$parse_()!==a?(Ae=_,_=y=peg$c109(0,0,0,0,0,y)):(ve=_,_=a);$!==a&&(_=peg$parse_())!==a&&(y=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(125===e.charCodeAt(ve)?(b=E,ve++):(b=a,0===Ce&&peg$fail(C)),b!==a?(Ae=t,T=p,O=i,S=o,M=h,I=$,q=y,t=r={_type:"with",with:{_type:"defv",isParam:!1,doc:(j=s)?j[0]:null,tex:T?T[0]:null,sealed:!1,type:O,name:S,expr:M,location:location()},def$s:I,expr:q,location:location()}):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;else ve=t,t=a;return je[F]={nextPos:ve,result:t},t}function peg$parseexpr_internal_3(){var e,t=43*ve+18,r=je[t];return r?(ve=r.nextPos,r.result):((e=peg$parsereduction())===a&&(e=peg$parseexpr_internal_2()),je[t]={nextPos:ve,result:e},e)}function peg$parseexpr_internal_2(){var e,t=43*ve+19,r=je[t];return r?(ve=r.nextPos,r.result):((e=peg$parsetee())===a&&(e=peg$parseexpr_internal_1()),je[t]={nextPos:ve,result:e},e)}function peg$parseexpr_internal_1(){var t,r,n,s,p=43*ve+20,i=je[p];return i?(ve=i.nextPos,i.result):((t=peg$parseschemacall())===a&&(t=peg$parsevar())===a&&(t=peg$parseschemaexpr())===a&&(t=peg$parsewith())===a&&(t=ve,40===e.charCodeAt(ve)?(r=x,ve++):(r=a,0===Ce&&peg$fail(m)),r!==a&&peg$parse_()!==a&&(n=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(s=v,ve++):(s=a,0===Ce&&peg$fail(A)),s!==a?(Ae=t,t=r=n):(ve=t,t=a)):(ve=t,t=a)),je[p]={nextPos:ve,result:t},t)}function peg$parseobjectexpr(){var t,r,n,s,p=43*ve+21,i=je[p];return i?(ve=i.nextPos,i.result):((t=peg$parsefuncall())===a&&(t=peg$parsefunexpr())===a&&(t=peg$parsevar())===a&&(t=ve,40===e.charCodeAt(ve)?(r=x,ve++):(r=a,0===Ce&&peg$fail(m)),r!==a&&peg$parse_()!==a&&(n=peg$parseobjectexpr())!==a&&peg$parse_()!==a?(41===e.charCodeAt(ve)?(s=v,ve++):(s=a,0===Ce&&peg$fail(A)),s!==a?(Ae=t,t=r=n):(ve=t,t=a)):(ve=t,t=a)),je[p]={nextPos:ve,result:t},t)}function peg$parsedefdollar(){var t,r,n,s,p=43*ve+22,i=je[p];return i?(ve=i.nextPos,i.result):(t=ve,(r=peg$parsedollar_ident())!==a&&peg$parse_()!==a?(61===e.charCodeAt(ve)?(n=u,ve++):(n=a,0===Ce&&peg$fail(f)),n!==a&&peg$parse_()!==a&&(s=peg$parseexpr_internal_3())!==a&&peg$parse_()!==a&&peg$parsesem()!==a?(Ae=t,t=r={_type:"def$",name:r,expr:s,location:location()}):(ve=t,t=a)):(ve=t,t=a),je[p]={nextPos:ve,result:t},t)}function peg$parsetype(){var e,t=43*ve+23,r=je[t];return r?(ve=r.nextPos,r.result):((e=function peg$parsestype(){var e,t,r=43*ve+24,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parseident())!==a&&(Ae=e,t={_type:"type",ftype:!1,name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}())===a&&(e=peg$parseftype()),je[t]={nextPos:ve,result:e},e)}function peg$parseftype(){var t,r,n,s,p,i,l,o,u,f,c=43*ve+25,h=je[c];if(h)return ve=h.nextPos,h.result;if(t=ve,91===e.charCodeAt(ve)?(r=k,ve++):(r=a,0===Ce&&peg$fail(R)),r!==a)if(peg$parse_()!==a){if(n=ve,(s=peg$parsetype())!==a){for(p=[],i=ve,(l=peg$parse_())!==a?(44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parsetype())!==a?(Ae=i,i=l=peg$c113(0,f)):(ve=i,i=a)):(ve=i,i=a);i!==a;)p.push(i),i=ve,(l=peg$parse_())!==a?(44===e.charCodeAt(ve)?(o=y,ve++):(o=a,0===Ce&&peg$fail(b)),o!==a&&(u=peg$parse_())!==a&&(f=peg$parsetype())!==a?(Ae=i,i=l=peg$c113(0,f)):(ve=i,i=a)):(ve=i,i=a);p!==a?(Ae=n,n=s=peg$c66(s,p)):(ve=n,n=a)}else ve=n,n=a;n!==a&&(s=peg$parse_())!==a?("->"===e.substr(ve,2)?(p="->",ve+=2):(p=a,0===Ce&&peg$fail(J)),p!==a&&(i=peg$parse_())!==a&&(l=peg$parsetype())!==a&&(o=peg$parse_())!==a?(93===e.charCodeAt(ve)?(u=H,ve++):(u=a,0===Ce&&peg$fail(D)),u!==a?(Ae=t,t=r={_type:"type",ftype:!0,from:n,to:l,location:location()}):(ve=t,t=a)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;else ve=t,t=a;return je[c]={nextPos:ve,result:t},t}function peg$parsevar(){var t,r=43*ve+26,n=je[r];return n?(ve=n.nextPos,n.result):((t=function peg$parseat_var(){var t,r,n=43*ve+27,s=je[n];if(s)return ve=s.nextPos,s.result;t=ve,(r=function peg$parseat_ident(){var t,r,n,s,p,i=43*ve+33,l=je[i];if(l)return ve=l.nextPos,l.result;t=ve,r=ve,64===e.charCodeAt(ve)?(n="@",ve++):(n=a,0===Ce&&peg$fail(d));if(n!==a){if(s=[],re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae)),p!==a)for(;p!==a;)s.push(p),re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;t=r!==a?e.substring(t,ve):r;return je[i]={nextPos:ve,result:t},t}())!==a&&(Ae=t,r={_type:"var",type:"@",name:r,location:location()});return t=r,je[n]={nextPos:ve,result:t},t}())===a&&(t=function peg$parsedollar_var(){var e,t,r=43*ve+28,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parsedollar_ident())!==a&&(Ae=e,t={_type:"var",type:"$",name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}())===a&&(t=function peg$parseplain_var(){var e,t,r=43*ve+29,n=je[r];if(n)return ve=n.nextPos,n.result;e=ve,(t=peg$parseident())!==a&&(Ae=e,t={_type:"var",type:"normal",name:t,location:location()});return e=t,je[r]={nextPos:ve,result:e},e}()),je[r]={nextPos:ve,result:t},t)}function peg$parseannotation(){var t,r=43*ve+31,n=je[r];return n?(ve=n.nextPos,n.result):(e.substr(ve,12)===K?(t=K,ve+=12):(t=a,0===Ce&&peg$fail(Y)),t===a&&(e.substr(ve,11)===ee?(t=ee,ve+=11):(t=a,0===Ce&&peg$fail(te))),je[r]={nextPos:ve,result:t},t)}function peg$parseident(){var t,r,n,s,u,f,g,d=43*ve+32,$=je[d];if($)return ve=$.nextPos,$.result;if(t=ve,r=ve,n=ve,Ce++,s=ve,(u=function peg$parsekeyword(){var t,r=43*ve+30,n=je[r];return n?(ve=n.nextPos,n.result):(e.substr(ve,2)===U?(t=U,ve+=2):(t=a,0===Ce&&peg$fail(z)),t===a&&(e.substr(ve,5)===j?(t=j,ve+=5):(t=a,0===Ce&&peg$fail(T)),t===a&&(e.substr(ve,6)===p?(t=p,ve+=6):(t=a,0===Ce&&peg$fail(i)),t===a&&(e.substr(ve,6)===M?(t=M,ve+=6):(t=a,0===Ce&&peg$fail(I)),t===a&&(e.substr(ve,6)===c?(t=c,ve+=6):(t=a,0===Ce&&peg$fail(h)),t===a&&(e.substr(ve,7)===O?(t=O,ve+=7):(t=a,0===Ce&&peg$fail(S)),t===a&&(e.substr(ve,4)===l?(t=l,ve+=4):(t=a,0===Ce&&peg$fail(o)),t===a&&(e.substr(ve,5)===q?(t=q,ve+=5):(t=a,0===Ce&&peg$fail(F)),t===a&&(e.substr(ve,4)===B?(t=B,ve+=4):(t=a,0===Ce&&peg$fail(G)))))))))),je[r]={nextPos:ve,result:t},t)}())!==a?(f=ve,Ce++,re.test(e.charAt(ve))?(g=e.charAt(ve),ve++):(g=a,0===Ce&&peg$fail(ae)),Ce--,g===a?f=void 0:(ve=f,f=a),f!==a?s=u=[u,f]:(ve=s,s=a)):(ve=s,s=a),Ce--,s===a?n=void 0:(ve=n,n=a),n!==a){if(s=[],re.test(e.charAt(ve))?(u=e.charAt(ve),ve++):(u=a,0===Ce&&peg$fail(ae)),u!==a)for(;u!==a;)s.push(u),re.test(e.charAt(ve))?(u=e.charAt(ve),ve++):(u=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;return t=r!==a?e.substring(t,ve):r,je[d]={nextPos:ve,result:t},t}function peg$parsedollar_ident(){var t,r,n,s,p,i=43*ve+34,l=je[i];if(l)return ve=l.nextPos,l.result;if(t=ve,r=ve,36===e.charCodeAt(ve)?(n=ne,ve++):(n=a,0===Ce&&peg$fail(se)),n!==a){if(s=[],re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae)),p!==a)for(;p!==a;)s.push(p),re.test(e.charAt(ve))?(p=e.charAt(ve),ve++):(p=a,0===Ce&&peg$fail(ae));else s=a;s!==a?r=n=[n,s]:(ve=r,r=a)}else ve=r,r=a;return t=r!==a?e.substring(t,ve):r,je[i]={nextPos:ve,result:t},t}function peg$parsedocumentation(){var t,r,n,s,p,i,l,o=43*ve+35,u=je[o];if(u)return ve=u.nextPos,u.result;if(t=ve,34===e.charCodeAt(ve)?(r=pe,ve++):(r=a,0===Ce&&peg$fail(ie)),r!==a){for(n=ve,s=[],p=ve,i=ve,Ce++,34===e.charCodeAt(ve)?(l=pe,ve++):(l=a,0===Ce&&peg$fail(ie)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);p!==a;)s.push(p),p=ve,i=ve,Ce++,34===e.charCodeAt(ve)?(l=pe,ve++):(l=a,0===Ce&&peg$fail(ie)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);(n=s!==a?e.substring(n,ve):s)!==a?(34===e.charCodeAt(ve)?(s=pe,ve++):(s=a,0===Ce&&peg$fail(ie)),s!==a?(Ae=t,t=r=peg$c132(n)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[o]={nextPos:ve,result:t},t}function peg$parsetex(){var t,r,n,s,p,i,l,o=43*ve+37,u=je[o];if(u)return ve=u.nextPos,u.result;if(t=ve,36===e.charCodeAt(ve)?(r=ne,ve++):(r=a,0===Ce&&peg$fail(se)),r!==a){for(n=ve,s=[],p=ve,i=ve,Ce++,36===e.charCodeAt(ve)?(l=ne,ve++):(l=a,0===Ce&&peg$fail(se)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);p!==a;)s.push(p),p=ve,i=ve,Ce++,36===e.charCodeAt(ve)?(l=ne,ve++):(l=a,0===Ce&&peg$fail(se)),Ce--,l===a?i=void 0:(ve=i,i=a),i!==a?(e.length>ve?(l=e.charAt(ve),ve++):(l=a,0===Ce&&peg$fail(le)),l!==a?(Ae=p,p=i=l):(ve=p,p=a)):(ve=p,p=a);(n=s!==a?e.substring(n,ve):s)!==a?(36===e.charCodeAt(ve)?(s=ne,ve++):(s=a,0===Ce&&peg$fail(se)),s!==a?(Ae=t,t=r=peg$c132(n)):(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[o]={nextPos:ve,result:t},t}function peg$parsecomment(){var t,r,n,s,p,i,l=43*ve+38,o=je[l];if(o)return ve=o.nextPos,o.result;if(t=ve,"//"===e.substr(ve,2)?(r="//",ve+=2):(r=a,0===Ce&&peg$fail(he)),r!==a){for(n=[],s=ve,p=ve,Ce++,i=peg$parsenewline(),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);s!==a;)n.push(s),s=ve,p=ve,Ce++,i=peg$parsenewline(),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);n!==a?t=r=[r,n]:(ve=t,t=a)}else ve=t,t=a;if(t===a)if(t=ve,"/*"===e.substr(ve,2)?(r="/*",ve+=2):(r=a,0===Ce&&peg$fail(ge)),r!==a){for(n=[],s=ve,p=ve,Ce++,e.substr(ve,2)===de?(i=de,ve+=2):(i=a,0===Ce&&peg$fail($e)),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);s!==a;)n.push(s),s=ve,p=ve,Ce++,e.substr(ve,2)===de?(i=de,ve+=2):(i=a,0===Ce&&peg$fail($e)),Ce--,i===a?p=void 0:(ve=p,p=a),p!==a?(e.length>ve?(i=e.charAt(ve),ve++):(i=a,0===Ce&&peg$fail(le)),i!==a?s=p=[p,i]:(ve=s,s=a)):(ve=s,s=a);n!==a?(e.substr(ve,2)===de?(s=de,ve+=2):(s=a,0===Ce&&peg$fail($e)),s!==a?t=r=[r,n,s]:(ve=t,t=a)):(ve=t,t=a)}else ve=t,t=a;return je[l]={nextPos:ve,result:t},t}function peg$parsenewline(){var t,r=43*ve+39,n=je[r];return n?(ve=n.nextPos,n.result):("\r\n"===e.substr(ve,2)?(t="\r\n",ve+=2):(t=a,0===Ce&&peg$fail(_e)),t===a&&(13===e.charCodeAt(ve)?(t="\r",ve++):(t=a,0===Ce&&peg$fail(xe)),t===a&&(10===e.charCodeAt(ve)?(t="\n",ve++):(t=a,0===Ce&&peg$fail(me)))),je[r]={nextPos:ve,result:t},t)}function peg$parse_(){var t,r,n=43*ve+40,s=je[n];if(s)return ve=s.nextPos,s.result;for(t=[],ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());r!==a;)t.push(r),ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());return je[n]={nextPos:ve,result:t},t}function peg$parse__(){var t,r,n=43*ve+41,s=je[n];if(s)return ve=s.nextPos,s.result;if(t=[],ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment()),r!==a)for(;r!==a;)t.push(r),ye.test(e.charAt(ve))?(r=e.charAt(ve),ve++):(r=a,0===Ce&&peg$fail(be)),r===a&&(r=peg$parsecomment());else t=a;return je[n]={nextPos:ve,result:t},t}function peg$parsesem(){var t,r=43*ve+42,n=je[r];return n?(ve=n.nextPos,n.result):(59===e.charCodeAt(ve)?(t=";",ve++):(t=a,0===Ce&&peg$fail(X)),je[r]={nextPos:ve,result:t},t)}if((r=s())!==a&&ve===e.length)return r;throw r!==a&&ve<e.length&&peg$fail({type:"end"}),peg$buildStructuredError(Ee,we<e.length?e.charAt(we):null,we<e.length?peg$computeLocation(we,we+1):peg$computeLocation(we,we))}}}]).default}));
//# sourceMappingURL=math-o-matic.min.js.map